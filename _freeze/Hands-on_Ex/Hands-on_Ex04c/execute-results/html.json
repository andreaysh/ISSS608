{
  "hash": "29403f8f6e4bc07470344ac91263ccf9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Hands-on Exercise 04c\"\nauthor: \"Andrea Yeo\"\ndate-modified: \"last-modified\"\nexecute:\n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n\n[With the assistance of ChatGPT]{style=\"font-size: 14px;\"}\n\n## 4. Visualising uncertainty\n\n### 4.1 Learning outcome\n\nIn this chapter, we will be learning how to create statistical graphics to visualize uncertainty. By the end of the chapter, we will be able to:\n\n-   Create statistical error bar plots using ggplot2.\n-   Develop interactive error bar plots by integrating ggplot2, plotly, and DT.\n-   Design advanced visualizations with the ggdist package.\n-   Generate Hypothetical Outcome Plots (HOPs) using the ungeviz package.\n\n### 4.2 Getting started\n\n#### 4.2.1 Installing and loading the packages\n\nFor this exercise the following R packages will be used:\n\n-   [tidyverse](https://www.rdocumentation.org/packages/tidyverse/versions/2.0.0): A collection of R packages for data science workflows\n-   [plotly](https://www.rdocumentation.org/packages/plotly/versions/4.10.4): Used for creating interactive plots.\n-   [gganimate](https://www.rdocumentation.org/packages/gganimate/versions/0.1.1):Enables the creation of animated plots.\n-   [DT](https://www.rdocumentation.org/packages/DT/versions/0.16):Displays interactive HTML tables.\n-   [crosstalk](https://www.rdocumentation.org/packages/crosstalk/versions/1.2.1):Facilitates cross-widget interactions, including linked brushing and filtering.\n-   [ggdist](https://www.rdocumentation.org/packages/ggdist/versions/3.3.2):Helps visualize distributions and uncertainty.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::install_github(\"wilkelab/ungeviz\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ungeviz, plotly, crosstalk,\n               DT, ggdist, ggridges,\n               colorspace, gganimate, tidyverse)\n```\n:::\n\n\n\n#### 4.2.2 Data import\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam <- read_csv(\"data/Exam_data.csv\", show_col_types = FALSE)\n```\n:::\n\n\n\n::: callout-note\n-   This section data is the same dataset used in [Hands-on_Ex01](Hands-on_Ex01.html), [Hands-on_Ex02](Hands-on_Ex02.html), [Hands-on_Ex03a](Hands-on_Ex03a.html), [Hands-on_Ex04a](Hands-on_Ex04a.html), and [Hands-on_Ex04b](Hands-on_Ex04b.html)\n:::\n\n### 4.3 Visualizing the uncertainty of point estimates: [`ggplot2`](https://www.rdocumentation.org/packages/ggplot2/versions/3.5.0) methods\n\nA point estimate is a single number, such as a mean. Uncertainty is expressed as standard error, confidence interval, or credible interval\n\n::: callout-important\nWe should not confuse the uncertainty of a point estimate with the variation in the sample.\n:::\n\nIn this section, we will be plotting error bars for MATHS scores based on race using the exam tibble data frame.\n\nThe following functions from the [dplyr](https://www.rdocumentation.org/packages/dplyr/versions/0.7.8) package and code will be used to calculate the required summary statistics.\n\n-   `group_by()`:Groups the observations by RACE.\n-   `summarise()`: Calculates the count of observations, along with the mean and standard deviation of MATHS scores.\n-   `mutate()`: Computes the standard error of MATHS scores for each race.\n-   The output is stored as a tibble data frame named *my_sum*.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_sum <- exam %>%\n  group_by(RACE) %>%\n  summarise(\n    n=n(),\n    mean=mean(MATHS),\n    sd=sd(MATHS)\n    ) %>%\n  mutate(se=sd/sqrt(n-1))\n```\n:::\n\n\n\n::: callout-note\n-   To refer to Slide 20 of Lesson 4 for the mathematical explanation\n:::\n\nThe code below will be used to display *my_sum* tibble data frame in a html table format.\n\n::: panel-tabset\n## Code()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(head(my_sum), format = 'html')\n```\n:::\n\n\n\n## Table()\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> RACE </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> sd </th>\n   <th style=\"text-align:right;\"> se </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Chinese </td>\n   <td style=\"text-align:right;\"> 193 </td>\n   <td style=\"text-align:right;\"> 76.50777 </td>\n   <td style=\"text-align:right;\"> 15.69040 </td>\n   <td style=\"text-align:right;\"> 1.132357 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Indian </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 60.66667 </td>\n   <td style=\"text-align:right;\"> 23.35237 </td>\n   <td style=\"text-align:right;\"> 7.041005 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Malay </td>\n   <td style=\"text-align:right;\"> 108 </td>\n   <td style=\"text-align:right;\"> 57.44444 </td>\n   <td style=\"text-align:right;\"> 21.13478 </td>\n   <td style=\"text-align:right;\"> 2.043177 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Others </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 69.66667 </td>\n   <td style=\"text-align:right;\"> 10.72381 </td>\n   <td style=\"text-align:right;\"> 3.791438 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n\n#### 4.3.1 Plotting standard error bars of point estimates\n\nNow, we will plot the standard error bars for the mean MATHS scores by race, as shown below.\n\n-   The error bars are computed by using the formula mean+/-se.\n-   For `geom_point()`, it is important to indicate stat=“identity”\n\n::: panel-tabset\n## Code()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(my_sum) +\n  geom_errorbar(\n    aes(x=RACE, \n        ymin=mean-se, \n        ymax=mean+se), \n    width=0.2, \n    colour=\"blue\", \n    alpha=0.9, \n    size=0.5) +\n  geom_point(aes\n           (x=RACE, \n            y=mean), \n           stat=\"identity\", \n           color=\"red\",\n           size = 1.5,\n           alpha=1) +\n  ggtitle(\"Standard error of mean maths score by rac\")\n```\n:::\n\n\n\n## Graph()\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex04c_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n:::\n\n#### 4.3.2 Plotting confidence interval of point estimates\n\nIn addition to plotting standard error bars for point estimates, we can also visualize the confidence intervals of the mean MATHS scores by race.\n\n-   The confidence intervals are calculated using the formula: mean ± 1.96 × standard error (SE).\n\n-   The error bars are arranged based on the average MATHS scores.\n\n-   The `labs()` function from ggplot2 is used to modify the x-axis label.\n\n::: panel-tabset\n## Code()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(my_sum) +\n  geom_errorbar(\n    aes(x=reorder(RACE, -mean), \n        ymin=mean-1.96*se, \n        ymax=mean+1.96*se), \n    width=0.2, \n    colour=\"blue\", \n    alpha=0.9, \n    size=0.5) +\n  geom_point(aes\n           (x=RACE, \n            y=mean), \n           stat=\"identity\", \n           color=\"red\",\n           size = 1.5,\n           alpha=1) +\n  labs(x = \"Maths score\",\n       title = \"95% confidence interval of mean maths score by race\")\n```\n:::\n\n\n\n## Graph()\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex04c_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n:::\n\n#### 4.3.3 Visualizing the uncertainty of point estimates with interactive error bars\n\nWe will learn how to create interactive error bar plots to display the 99% confidence intervals of the mean MATHS scores by race, as shown in the figure below.\n\n::: panel-tabset\n## Code()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshared_df = SharedData$new(my_sum)\n\nbscols(widths = c(4,8),\n       ggplotly((ggplot(shared_df) +\n                   geom_errorbar(aes(\n                     x=reorder(RACE, -mean),\n                     ymin=mean-2.58*se, \n                     ymax=mean+2.58*se), \n                     width=0.2, \n                     colour=\"blue\", \n                     alpha=0.9, \n                     size=0.5) +\n                   geom_point(aes(\n                     x=RACE, \n                     y=mean, \n                     text = paste(\"Race:\", `RACE`, \n                                  \"<br>N:\", `n`,\n                                  \"<br>Avg. Scores:\", round(mean, digits = 2),\n                                  \"<br>95% CI:[\", \n                                  round((mean-2.58*se), digits = 2), \",\",\n                                  round((mean+2.58*se), digits = 2),\"]\")),\n                     stat=\"identity\", \n                     color=\"red\", \n                     size = 1.5, \n                     alpha=1) + \n                   xlab(\"Race\") + \n                   ylab(\"Average Scores\") + \n                   theme_minimal() + \n                   theme(axis.text.x = element_text(\n                     angle = 45, vjust = 0.5, hjust=1)) +\n                   ggtitle(\"99% Confidence interval of average /<br>maths scores by race\")), \n                tooltip = \"text\"), \n       DT::datatable(shared_df, \n                     rownames = FALSE, \n                     class=\"compact\", \n                     width=\"100%\", \n                     options = list(pageLength = 10,\n                                    scrollX=T), \n                     colnames = c(\"No. of pupils\", \n                                  \"Avg Scores\",\n                                  \"Std Dev\",\n                                  \"Std Error\")) %>%\n         formatRound(columns=c('mean', 'sd', 'se'),\n                     digits=2))\n```\n:::\n\n\n\n## Graph()\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"container-fluid crosstalk-bscols\">\n<div class=\"row\">\n<div class=\"col-xs-4\">\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-97390b2cd361835df235\" style=\"width:100%;height:400px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-97390b2cd361835df235\">{\"x\":{\"data\":[{\"x\":[1,3,4,2],\"y\":[76.507772020725383,60.666666666666664,57.444444444444443,69.666666666666671],\"text\":\"\",\"key\":[\"1\",\"2\",\"3\",\"4\"],\"type\":\"scatter\",\"mode\":\"lines\",\"opacity\":0.90000000000000002,\"line\":{\"color\":\"transparent\"},\"error_y\":{\"array\":[2.9214818033282057,18.165794029639137,5.2713960499886028,9.7819093228264933],\"arrayminus\":[2.9214818033282057,18.165794029639137,5.2713960499886028,9.7819093228265004],\"type\":\"data\",\"width\":21.333333333333353,\"symmetric\":false,\"color\":\"rgba(0,0,255,1)\"},\"set\":\"SharedData82cf8293\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"_isNestedKey\":false,\"frame\":null},{\"x\":[1,3,4,2],\"y\":[76.507772020725383,60.666666666666664,57.444444444444443,69.666666666666671],\"text\":[\"Race: Chinese <br>N: 193 <br>Avg. Scores: 76.51 <br>95% CI:[ 73.59 , 79.43 ]\",\"Race: Indian <br>N: 12 <br>Avg. Scores: 60.67 <br>95% CI:[ 42.5 , 78.83 ]\",\"Race: Malay <br>N: 108 <br>Avg. Scores: 57.44 <br>95% CI:[ 52.17 , 62.72 ]\",\"Race: Others <br>N: 9 <br>Avg. Scores: 69.67 <br>95% CI:[ 59.88 , 79.45 ]\"],\"key\":[\"1\",\"2\",\"3\",\"4\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(255,0,0,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,0,0,1)\"}},\"hoveron\":\"points\",\"set\":\"SharedData82cf8293\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"_isNestedKey\":false,\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":50.845818773908846,\"l\":37.260273972602747},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"99% Confidence interval of average /<br>maths scores by race\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,4.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Chinese\",\"Others\",\"Indian\",\"Malay\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"Chinese\",\"Others\",\"Indian\",\"Malay\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-45,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Race\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[40.653487469404247,81.295961157116452],\"tickmode\":\"array\",\"ticktext\":[\"50\",\"60\",\"70\",\"80\"],\"tickvals\":[50,60,70,80],\"categoryorder\":\"array\",\"categoryarray\":[\"50\",\"60\",\"70\",\"80\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Average Scores\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498}},\"hovermode\":\"closest\",\"barmode\":\"relative\",\"dragmode\":\"zoom\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"2c3c1252146a\":{\"x\":{},\"ymin\":{},\"ymax\":{},\"type\":\"scatter\"},\"2c3c30e91845\":{\"x\":{},\"y\":{},\"text\":{}}},\"cur_data\":\"2c3c1252146a\",\"visdat\":{\"2c3c1252146a\":[\"function (y) \",\"x\"],\"2c3c30e91845\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0,\"ctGroups\":[\"SharedData82cf8293\"]},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n</div>\n<div class=\"col-xs-8\">\n<div id=\"htmlwidget-4e1d88b1bbda6371935a\" style=\"width:100%;height:auto;\" class=\"datatables html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-4e1d88b1bbda6371935a\">{\"x\":{\"crosstalkOptions\":{\"key\":[\"1\",\"2\",\"3\",\"4\"],\"group\":\"SharedData82cf8293\"},\"filter\":\"none\",\"vertical\":false,\"data\":[[\"Chinese\",\"Indian\",\"Malay\",\"Others\"],[193,12,108,9],[76.50777202072538,60.66666666666666,57.44444444444444,69.66666666666667],[15.69040284264306,23.35237318418266,21.13478478068458,10.72380529476361],[1.132357288111705,7.041005437844626,2.043176763561474,3.791437722025775]],\"container\":\"<table class=\\\"compact\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>No. of pupils<\\/th>\\n      <th>Avg Scores<\\/th>\\n      <th>Std Dev<\\/th>\\n      <th>Std Error<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"scrollX\":true,\"columnDefs\":[{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":4,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"className\":\"dt-right\",\"targets\":[1,2,3,4]},{\"orderable\":false,\"targets\":0},{\"name\":\"RACE\",\"targets\":0},{\"name\":\"n\",\"targets\":1},{\"name\":\"mean\",\"targets\":2},{\"name\":\"sd\",\"targets\":3},{\"name\":\"se\",\"targets\":4}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\",\"options.columnDefs.2.render\"],\"jsHooks\":[]}</script>\n</div>\n</div>\n</div>\n```\n\n:::\n:::\n\n\n:::\n\n### 4.4 Visualizing uncertainty: [`ggdist`](https://mjskay.github.io/ggdist/index.html) methods\n\n-   [ggdist](https://mjskay.github.io/ggdist/index.html) is an R package that offers flexible ggplot2 geoms and stats specifically designed for visualizing distributions and uncertainty.\n\n-   It supports both frequentist and Bayesian uncertainty visualization by focusing on distribution-based approaches:\n\n    -   For frequentist models, it visualizes confidence or bootstrap distributions (see vignette(\"freq-uncertainty-vis\")).\n\n    -   For Bayesian models, it visualizes probability distributions, with extended functionality available through the tidybayes package.\n\n#### 4.4.1 Visualizing the uncertainty of point estimates: [`ggdist`](https://www.rdocumentation.org/packages/ggdist/versions/3.3.2) methods\n\n[`stat_pointinterval()`](https://mjskay.github.io/ggdist/reference/stat_pointinterval.html) of **ggdist** is used to build a visual for displaying distribution of maths scores by race.\n\n::: panel-tabset\n## Code()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam %>%\n  ggplot(aes(x = RACE, \n             y = MATHS)) +\n  stat_pointinterval() +\n  labs(\n    title = \"Visualising confidence intervals of mean math score\",\n    subtitle = \"Mean Point + Multiple-interval plot\")\n```\n:::\n\n\n\n## Graph()\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex04c_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n:::\n\nThis function comes with many arguments. In the code below, the following arguments are used:\n\n-   width = 0.95\n\n-   point = median\n\n-   interval = qi\n\nFor more information on the arguments available, please refer to this [link](https://www.rdocumentation.org/packages/tidybayes/versions/2.0.3/topics/stat_pointinterval).\n\n::: panel-tabset\n## Code()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam %>%\n  ggplot(aes(x = RACE, y = MATHS)) +\n  stat_pointinterval(.width = 0.95,\n  .point = median,\n  .interval = qi) +\n  labs(\n    title = \"Visualising confidence intervals of median math score\",\n    subtitle = \"Median Point + Multiple-interval plot\")\n```\n:::\n\n\n\n## Graph()\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex04c_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n:::\n\n#### 4.4.2 Visualizing the uncertainty of point estimates: [`ggdist`](https://www.rdocumentation.org/packages/ggdist/versions/3.3.2) methods\n\nWe will makeover the previous plot by showing 95% and 99% confidence intervals. \n\n-   .width = 0.95 and 0.99\n\n::: callout-note\n-   The `.width` argument in the `stat_pointinterval` function defines the coverage probability of the confidence interval around the summary statistic, such as the median.\n-   It controls the visual width of the confidence interval displayed in the plot.\n:::\n\n::: panel-tabset\n## Code()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam %>%\n  ggplot(aes(x = RACE, \n             y = MATHS)) +\n  stat_pointinterval(\n    .width = c(0.95, 0.99), \n    show.legend = FALSE) +   \n  labs(\n    title = \"Visualising confidence intervals of mean Math score\",\n    subtitle = \"Mean Point + Multiple-interval plot\")\n```\n:::\n\n\n\n## Graph()\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex04c_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n:::\n\n#### 4.4.3 Visualizing the uncertainty of point estimates: [`ggdist`](https://www.rdocumentation.org/packages/ggdist/versions/3.3.2) methods\n\n[`stat_gradientinterval()`](https://mjskay.github.io/ggdist/reference/stat_gradientinterval.html) of **ggdist** is used to build a visual for displaying distribution of maths scores by race. \n\n::: panel-tabset\n## Code()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam %>%\n  ggplot(aes(x = RACE, \n             y = MATHS)) +\n  stat_gradientinterval(   \n    fill = \"#E1B941\",      \n    show.legend = TRUE     \n  ) +                        \n  labs(\n    title = \"Visualising confidence intervals of mean math score\",\n    subtitle = \"Gradient + interval plot\")\n```\n:::\n\n\n\n## Graph()\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex04c_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n:::\n\n### 4.5 Visualizing uncertainity with hypothetical outcome plots (HOPs)\n\nWhat are HOPs and when are they used?\n\n-   HOPs are visualizations that display multiple simulated outcomes to help users understand uncertainty in data or predictions. Instead of showing a static confidence interval, HOPs animate or present a series of possible outcomes to illustrate the variability in the data.\n-   Used to help audiences intuitively understand variability and potential results in decision-making and forecasting.\n\n::: panel-tabset\n## Code()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::install_github(\"wilkelab/ungeviz\")\nlibrary(ungeviz)\n\nggplot(data = exam, \n       (aes(x = factor(RACE), y = MATHS))) +\n  geom_point(position = position_jitter(\n    height = 0.3, width = 0.05), \n    size = 0.4, color = \"#E1B941\", alpha = 1/2) +\n  geom_hpline(data = sampler(25, group = RACE), height = 0.6, color = \"#4169E1\") +\n  theme_bw() + \n  # `.draw` is a generated column indicating the sample draw\n  transition_states(.draw, 1, 3)\n```\n:::\n\n\n\n## Graph()\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex04c_files/figure-html/unnamed-chunk-22-1.gif)\n:::\n:::\n\n\n:::\n\n### 4.7 References\n\n-   Kam, T.S(2024). [Visualising Uncertainty](https://r4va.netlify.app/chap11)\n\n### 4.8 Takeaway\n\n::: callout-tip\n## Key takeaways\n\n-   Understand uncertainty in statistical graphics: uncertainty is expressed using standard errors/ confidence intervals.\n-   Learnt about plotting error bars with ggplot2: use `geom_errorbar` to represent standard errors around point estimates\n-   Learnt about creating interactive error bars with `plotly` and `DT`\n-   Learnt about visualizing uncertainty with Hypothetical Outcome Plots (HOPs): displaying multiple stimulated outcomes to show data variability. \n-   Learnt the difference about the uncertainty of point estimates with same variation, where uncertainty reflects estimation confidence, while variation shows data spread. \n:::\n\n### 4.9 Further exploration\n\n1. To further explore Hypothetical Outcome Plots (HOPs) using `exam` dataset - By increasing the number of stimulated outcomes\n\n-   Increase the number of samples from 25 to 150.\n\n::: callout-note\n-   By increasing the number of samples, it shows more potential outcomes, providing a richer picture of uncertainty. \n:::\n\n::: panel-tabset\n## Code()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::install_github(\"wilkelab/ungeviz\")\nlibrary(ungeviz)\n\nggplot(data = exam, \n       aes(x = factor(RACE), y = MATHS)) +\n  geom_point(position = position_jitter(height = 0.3, width = 0.05), \n             size = 0.4, color = \"#E1B941\", alpha = 1/2) +\n  geom_hpline(data = sampler(150, group = RACE), height = 0.6, color = \"#4169E1\") +  # Increased from 25 to 150\n  theme_minimal() + \n  transition_states(.draw, transition_length = 2, state_length = 1)\n```\n:::\n\n\n\n## Graph()\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex04c_files/figure-html/unnamed-chunk-24-1.gif)\n:::\n:::\n\n\n:::\n\n2. To further visualize how confidence intervals for average MATHS scores shift across class (using `ggdist)\n\n::: callout-note\n-   Helps to track how uncertainty (confidence intervals) widens or narrows across different classes\n:::\n\n::: panel-tabset\n## Code()\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggdist)\nlibrary(gganimate)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Clean data to remove any missing CLASS values\nexam_clean <- exam %>% filter(!is.na(CLASS))\n\n# Animated plot\nggplot(exam_clean, aes(x = factor(CLASS), y = MATHS)) +\n  stat_pointinterval(aes(color = RACE), \n                      .width = c(0.66, 0.95), \n                      position = position_dodge(width = 0.5)) +\n  labs(title = \"Confidence Intervals of Maths Scores Across Classes\",\n       subtitle = \"Class: {closest_state}\",  # Dynamic subtitle reflecting the current class\n       y = \"Maths Score\") +\n  theme_minimal() +\n  transition_states(CLASS, transition_length = 2, state_length = 1) +  # Handles categorical data\n  ease_aes('cubic-in-out')  # Smooth animation transitions\n```\n:::\n\n\n## Animated Graph()\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex04c_files/figure-html/unnamed-chunk-26-1.gif)\n:::\n:::\n\n\n\n## Static Graph()\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex04c_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n:::\n\n",
    "supporting": [
      "Hands-on_Ex04c_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n<link href=\"../site_libs/bootstrap-grid-3.4.1/bootstrap-grid.min.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}