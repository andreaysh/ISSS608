<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrea Yeo">
<meta name="dcterms.date" content="2025-02-01">

<title>Take-home Exercise 01 – ISSS608 Coursework</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-ddd961a2510921635943dfbbd19534c4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ISSS608 Coursework</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex00.html">
 <span class="dropdown-text">Hands-on Exercise 00</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 01</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 02</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex03a.html">
 <span class="dropdown-text">Hands-on Exercise 03a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex03b.html">
 <span class="dropdown-text">Hands-on Exercise 03b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex04a.html">
 <span class="dropdown-text">Hands-on Exercise 04a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex04b.html">
 <span class="dropdown-text">Hands-on Exercise 04b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex04c.html">
 <span class="dropdown-text">Hands-on Exercise 04c</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex04d.html">
 <span class="dropdown-text">Hands-on Exercise 04d</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex05a.html">
 <span class="dropdown-text">Hands-on Exercise 05a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex05b.html">
 <span class="dropdown-text">Hands-on Exercise 05b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex05c.html">
 <span class="dropdown-text">Hands-on Exercise 05c</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex05d.html">
 <span class="dropdown-text">Hands-on Exercise 05d</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex05e.html">
 <span class="dropdown-text">Hands-on Exercise 05e</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../In-class_Ex/In-class_Outline.html">
 <span class="dropdown-text">In-class Exercise Outline</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://public.tableau.com/views/In-class_Ex01_17371867213230/Dashboard1?:language=en-US&amp;:sid=&amp;:redirect=auth&amp;:display_count=n&amp;:origin=viz_share_link">
 <span class="dropdown-text">In-class Exercise 01</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://public.tableau.com/views/In-class_Ex02_17377896182080/Dashboard2?:language=en-US&amp;:sid=&amp;:redirect=auth&amp;:display_count=n&amp;:origin=viz_share_link">
 <span class="dropdown-text">In-class Exercise 02</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://public.tableau.com/views/In-class_Ex03_17383925295110/Hands-on_Ex03?:language=en-US&amp;:sid=&amp;:redirect=auth&amp;:display_count=n&amp;:origin=viz_share_link">
 <span class="dropdown-text">In-class Exercise 03</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://public.tableau.com/views/In-class_Ex03_Story/Myfirststory?:language=en-US&amp;:sid=&amp;:redirect=auth&amp;:display_count=n&amp;:origin=viz_share_link">
 <span class="dropdown-text">In-class Exercise 03-Story</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://public.tableau.com/views/In-class_Ex03_Animation/Dashboard6?:language=en-US&amp;:sid=&amp;:redirect=auth&amp;:display_count=n&amp;:origin=viz_share_link">
 <span class="dropdown-text">In-class Exercise 03-Animation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 04</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../Take-home_Ex/Take-home_Ex01.html">
 <span class="dropdown-text">Take Home Exercise 1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#heart-attack-in-japan-youth-vs-adult" id="toc-heart-attack-in-japan-youth-vs-adult" class="nav-link active" data-scroll-target="#heart-attack-in-japan-youth-vs-adult">Heart Attack in Japan Youth Vs Adult</a>
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">1. Overview</a>
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">1.1 Background</a></li>
  <li><a href="#research-objective" id="toc-research-objective" class="nav-link" data-scroll-target="#research-objective">1.2 Research objective</a></li>
  </ul></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">2. Getting started</a>
  <ul>
  <li><a href="#loading-the-packages" id="toc-loading-the-packages" class="nav-link" data-scroll-target="#loading-the-packages">2.1 Loading the packages</a></li>
  </ul></li>
  <li><a href="#data-wrangling-data-prepration" id="toc-data-wrangling-data-prepration" class="nav-link" data-scroll-target="#data-wrangling-data-prepration">3. Data wrangling &amp; data prepration</a>
  <ul>
  <li><a href="#importing-the-data" id="toc-importing-the-data" class="nav-link" data-scroll-target="#importing-the-data">3.1 Importing the data</a></li>
  <li><a href="#checking-the-data-structure" id="toc-checking-the-data-structure" class="nav-link" data-scroll-target="#checking-the-data-structure">3.4 Checking the data structure</a></li>
  <li><a href="#understanding-the-metadata" id="toc-understanding-the-metadata" class="nav-link" data-scroll-target="#understanding-the-metadata">3.2 Understanding the metadata</a></li>
  <li><a href="#filtering-for-relevant-variables" id="toc-filtering-for-relevant-variables" class="nav-link" data-scroll-target="#filtering-for-relevant-variables">3.3 Filtering for relevant variables</a></li>
  <li><a href="#recoding-and-creating-of-new-variables" id="toc-recoding-and-creating-of-new-variables" class="nav-link" data-scroll-target="#recoding-and-creating-of-new-variables">3.5 Recoding and creating of new variables</a>
  <ul class="collapse">
  <li><a href="#recoding-continuous-variables-into-categorical-variables" id="toc-recoding-continuous-variables-into-categorical-variables" class="nav-link" data-scroll-target="#recoding-continuous-variables-into-categorical-variables">3.5.1 Recoding continuous variables into categorical variables</a></li>
  <li><a href="#recoding-age-into-categorical-variable" id="toc-recoding-age-into-categorical-variable" class="nav-link" data-scroll-target="#recoding-age-into-categorical-variable">3.5.2 Recoding <code>age</code> into categorical variable</a></li>
  <li><a href="#checking-the-data-structure-after-filtering-and-recoding-of-variables" id="toc-checking-the-data-structure-after-filtering-and-recoding-of-variables" class="nav-link" data-scroll-target="#checking-the-data-structure-after-filtering-and-recoding-of-variables">3.5.3 Checking the data structure after filtering and recoding of variables</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">3.6 Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#eda-0---check-for-potential-bias-in-data-collection" id="toc-eda-0---check-for-potential-bias-in-data-collection" class="nav-link" data-scroll-target="#eda-0---check-for-potential-bias-in-data-collection">3.6.1 EDA 0 - check for potential bias in data collection</a></li>
  <li><a href="#eda-1---explore-how-age-influences-the-likelihood-of-heart-attack-incidents" id="toc-eda-1---explore-how-age-influences-the-likelihood-of-heart-attack-incidents" class="nav-link" data-scroll-target="#eda-1---explore-how-age-influences-the-likelihood-of-heart-attack-incidents">3.6.2 EDA 1 - explore how age influences the likelihood of heart attack incidents</a>
  <ul class="collapse">
  <li><a href="#age-distribution-of-heart-attack-patients---histogram" id="toc-age-distribution-of-heart-attack-patients---histogram" class="nav-link" data-scroll-target="#age-distribution-of-heart-attack-patients---histogram">3.6.2.1 Age distribution of heart attack patients - histogram</a></li>
  <li><a href="#heart-attack-rate-by-age-group---histogram" id="toc-heart-attack-rate-by-age-group---histogram" class="nav-link" data-scroll-target="#heart-attack-rate-by-age-group---histogram">3.6.2.2 Heart attack rate by age group - histogram</a></li>
  <li><a href="#age-distribution-differs-between-heart-attack-occurences---ridgeline-density-plot" id="toc-age-distribution-differs-between-heart-attack-occurences---ridgeline-density-plot" class="nav-link" data-scroll-target="#age-distribution-differs-between-heart-attack-occurences---ridgeline-density-plot">3.6.2.3 Age distribution differs between heart attack occurences - ridgeline density plot</a></li>
  <li><a href="#heart-attack-occurrence-across-age-categories-funnel-plot-analysis" id="toc-heart-attack-occurrence-across-age-categories-funnel-plot-analysis" class="nav-link" data-scroll-target="#heart-attack-occurrence-across-age-categories-funnel-plot-analysis">3.6.2.2 Heart Attack Occurrence Across Age Categories – Funnel Plot Analysis</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Take-home Exercise 01</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andrea Yeo </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 1, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">February 10, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="heart-attack-in-japan-youth-vs-adult" class="level1">
<h1>Heart Attack in Japan Youth Vs Adult</h1>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">1. Overview</h2>
<section id="background" class="level3">
<h3 class="anchored" data-anchor-id="background">1.1 Background</h3>
<p>This analysis explores heart attack incidents in Japan, focusing on the differences in risk factors between youth and adult age groups. With the growing global prevalence of heart disease, understanding <u><em>how age influences heart attack likelihood</em></u> and <u><em>identifying the strongest predictors</em></u> are crucial for shaping targeted prevention strategies and healthcare interventions.</p>
<p>The dataset from Kaggle - <a href="https://www.kaggle.com/datasets/ashaychoudhary/heart-attack-in-japan-youth-vs-adult">Heart Attack in Japan Youth Vs Adult</a> provides an opportunity to analyze these aspects, helping healthcare providers, policymakers, and researchers develop age-specific awareness campaigns, preventive measures, and resource allocation strategies tailored to reducing heart attack risks in Japan.</p>
</section>
<section id="research-objective" class="level3">
<h3 class="anchored" data-anchor-id="research-objective">1.2 Research objective</h3>
<p>Using the <a href="https://www.kaggle.com/datasets/ashaychoudhary/heart-attack-in-japan-youth-vs-adult">Heart Attack in Japan: Youth vs.&nbsp;Adult</a> dataset, this Take-home_Ex01 applies appropriate Exploratory Data Analysis (EDA) methods, using the <a href="https://www.tidyverse.org/">tidyverse</a> package and <a href="https://www.rdocumentation.org/packages/ggplot2/versions/0.9.0/topics/ggplot">ggplot</a> functions to:</p>
<ul>
<li><strong>explore how age influences the likelihood of heart attack incidents</strong></li>
<li><strong>identify the strongest predictors contributing to heart attack incidents</strong></li>
</ul>
</section>
</section>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">2. Getting started</h2>
<section id="loading-the-packages" class="level3">
<h3 class="anchored" data-anchor-id="loading-the-packages">2.1 Loading the packages</h3>
<p>The following R packages will be loaded for this exercise using <code>pacman::p_load()</code>:</p>
<ul>
<li><a href="https://www.rdocumentation.org/packages/readr/versions/2.1.5"><strong>readr</strong></a>: Part of a tidyverse package for fast and efficient reading of rectangular data (CSV, TSV, and other delimited files) into R</li>
<li><a href="https://www.rdocumentation.org/packages/dplyr/versions/0.5.0"><strong>dplyr</strong></a>: Part of a tidyverse package for efficient data manipulation, including filtering, selecting, mutating, summarizing, and grouping data in R</li>
<li><a href="https://www.rdocumentation.org/packages/ggplot2/versions/3.5.0"><strong>ggplot2</strong></a>: Part of a tidyverse package allowing for flexible and layered creation of complex plots</li>
<li><a href="https://www.rdocumentation.org/packages/tidyverse/versions/2.0.0"><strong>tidyverse</strong></a>: A collection of R packages for data manipulation, visualization, and analysis</li>
<li><a href="https://www.rdocumentation.org/packages/knitr/versions/1.48"><strong>knitr</strong></a>: Enables dynamic report generation with R Markdown</li>
<li><a href="https://www.rdocumentation.org/packages/patchwork/versions/0.0.1"><strong>patchwork</strong></a>: Combines multiple ggplot2 plots into a single layout</li>
<li><a href="https://www.rdocumentation.org/packages/ggthemes/versions/5.1.0"><strong>ggthemes</strong></a>: Provides additional themes and scales for ggplot2</li>
<li><a href="https://www.rdocumentation.org/packages/scales/versions/0.4.1"><strong>scales</strong></a>: Enhances visualization by formatting axes and legends in ggplot2</li>
<li><a href="https://www.rdocumentation.org/packages/ggridges/versions/0.5.6"><strong>ggridges</strong></a>: Creates ridge plots for density visualization</li>
<li><a href="https://www.rdocumentation.org/packages/ggpubr/versions/0.6.0"><strong>ggpubr</strong></a>: Simplifies publication-ready ggplot2 visualizations</li>
<li><a href="https://www.rdocumentation.org/packages/gganimate/versions/1.0.9"><strong>gganimate</strong></a>: Adds animation capabilities to ggplot2 graphics</li>
<li><a href="https://www.rdocumentation.org/packages/ggdist/versions/3.3.2"><strong>ggdist</strong></a>: Visualizes uncertainty and statistical distributions in ggplot2</li>
<li><a href="https://www.rdocumentation.org/packages/ggtext/versions/0.1.2"><strong>ggtext</strong></a>: Enhances text rendering and formatting in ggplot2</li>
<li><a href="https://www.rdocumentation.org/packages/GGally/versions/2.2.1"><strong>ggalt</strong></a>: Provides additional geoms, including dumbbell plots and lollipop charts</li>
<li><a href="https://www.rdocumentation.org/packages/cowplot/versions/1.1.3"><strong>cowplot</strong></a>: Enhances ggplot2-based layouts and plot annotations</li>
<li><a href="https://www.rdocumentation.org/packages/ggnewscale/versions/0.4.5"><strong>ggnewscale</strong></a>: Allows multiple color and fill scales in a single ggplot2 plot</li>
<li><a href="https://www.rdocumentation.org/packages/ggrepel/versions/0.9.6"><strong>ggrepel</strong></a>: Prevents overlapping text labels in ggplot2 plots</li>
<li><a href="https://www.rdocumentation.org/packages/rmeta/versions/3.0/topics/funnelplot"><strong>FunnelPlotrR</strong></a>:Used to create funnel plots for visualizing and comparing proportions, rates, or ratios across different groups while accounting for statistical variation.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, haven, knitr,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               patchwork, ggthemes, scales,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               ggridges, ggpubr, gganimate,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               ggdist, ggtext, ggalt,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               cowplot, ggnewscale,FunnelPlotR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="data-wrangling-data-prepration" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling-data-prepration">3. Data wrangling &amp; data prepration</h2>
<section id="importing-the-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-the-data">3.1 Importing the data</h3>
<p>The code chunk below imports the <a href="https://www.kaggle.com/datasets/ashaychoudhary/heart-attack-in-japan-youth-vs-adult">Heart Attack in Japan: Youth vs.&nbsp;Adult</a> dataset, downloaded from Kaggle, using the read_csv() function from the readr package.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>heart_attack <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/japan_heart_attack_dataset.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>heart_attack</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30,000 × 32
     Age Gender Region Smoking_History Diabetes_History Hypertension_History
   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;            &lt;chr&gt;               
 1    56 Male   Urban  Yes             No               No                  
 2    69 Male   Urban  No              No               No                  
 3    46 Male   Rural  Yes             No               No                  
 4    32 Female Urban  No              No               No                  
 5    60 Female Rural  No              No               No                  
 6    25 Female Rural  No              No               No                  
 7    78 Male   Urban  No              Yes              Yes                 
 8    38 Female Urban  Yes             No               No                  
 9    56 Male   Rural  No              No               Yes                 
10    75 Male   Urban  No              No               No                  
# ℹ 29,990 more rows
# ℹ 26 more variables: Cholesterol_Level &lt;dbl&gt;, Physical_Activity &lt;chr&gt;,
#   Diet_Quality &lt;chr&gt;, Alcohol_Consumption &lt;chr&gt;, Stress_Levels &lt;dbl&gt;,
#   BMI &lt;dbl&gt;, Heart_Rate &lt;dbl&gt;, Systolic_BP &lt;dbl&gt;, Diastolic_BP &lt;dbl&gt;,
#   Family_History &lt;chr&gt;, Heart_Attack_Occurrence &lt;chr&gt;, Extra_Column_1 &lt;dbl&gt;,
#   Extra_Column_2 &lt;dbl&gt;, Extra_Column_3 &lt;dbl&gt;, Extra_Column_4 &lt;dbl&gt;,
#   Extra_Column_5 &lt;dbl&gt;, Extra_Column_6 &lt;dbl&gt;, Extra_Column_7 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>The dataset is structured as a tibble dataframe, containing 30,000 rows and 32 columns. Each observation represents an individual case, and the variables capture key medical and demographic information relevant to heart attack incidents across different age groups in Japan.</p>
</section>
<section id="checking-the-data-structure" class="level3">
<h3 class="anchored" data-anchor-id="checking-the-data-structure">3.4 Checking the data structure</h3>
<p>We will check the dataset using below</p>
<ul>
<li><code>glimpse()</code>: provides a transposed overview of a dataset, showing variables and their types in a concise format.</li>
<li><code>head()</code>: displays the first few rows of a dataset (default is 6 rows) to give a quick preview of the data.</li>
<li><code>summary()</code>: generates a statistical summary of each variable, including measures like mean, median, and range for numeric data.</li>
<li><code>duplicated()</code>:returns a logical vector indicating which elements or rows in a vector or data frame are duplicates.</li>
<li><code>colSums(is.na())</code>: counts the number of missing values (NA) in each column of the data frame.</li>
<li><code>spec()</code>: use <code>spec()</code> to quickly inspect the column</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">glimpse()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">head()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">summary()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">duplicated()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">colSum(is.na())</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">spec())</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(heart_attack)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 30,000
Columns: 32
$ Age                     &lt;dbl&gt; 56, 69, 46, 32, 60, 25, 78, 38, 56, 75, 36, 40…
$ Gender                  &lt;chr&gt; "Male", "Male", "Male", "Female", "Female", "F…
$ Region                  &lt;chr&gt; "Urban", "Urban", "Rural", "Urban", "Rural", "…
$ Smoking_History         &lt;chr&gt; "Yes", "No", "Yes", "No", "No", "No", "No", "Y…
$ Diabetes_History        &lt;chr&gt; "No", "No", "No", "No", "No", "No", "Yes", "No…
$ Hypertension_History    &lt;chr&gt; "No", "No", "No", "No", "No", "No", "Yes", "No…
$ Cholesterol_Level       &lt;dbl&gt; 186.4002, 185.1367, 210.6966, 211.1655, 223.81…
$ Physical_Activity       &lt;chr&gt; "Moderate", "Low", "Low", "Moderate", "High", …
$ Diet_Quality            &lt;chr&gt; "Poor", "Good", "Average", "Good", "Good", "Go…
$ Alcohol_Consumption     &lt;chr&gt; "Low", "Low", "Moderate", "High", "High", "Hig…
$ Stress_Levels           &lt;dbl&gt; 3.644786, 3.384056, 3.810911, 6.014878, 6.8068…
$ BMI                     &lt;dbl&gt; 33.96135, 28.24287, 27.60121, 23.71729, 19.771…
$ Heart_Rate              &lt;dbl&gt; 72.30153, 57.45764, 64.65870, 55.13147, 76.667…
$ Systolic_BP             &lt;dbl&gt; 123.90209, 129.89331, 145.65490, 131.78522, 10…
$ Diastolic_BP            &lt;dbl&gt; 85.68281, 73.52426, 71.99481, 68.21133, 92.902…
$ Family_History          &lt;chr&gt; "No", "Yes", "No", "No", "No", "No", "No", "No…
$ Heart_Attack_Occurrence &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "No"…
$ Extra_Column_1          &lt;dbl&gt; 0.40498852, 0.03627815, 0.85297888, 0.39085280…
$ Extra_Column_2          &lt;dbl&gt; 0.43330004, 0.51256694, 0.21959083, 0.29684675…
$ Extra_Column_3          &lt;dbl&gt; 0.62871236, 0.66839275, 0.61343656, 0.15572404…
$ Extra_Column_4          &lt;dbl&gt; 0.70160955, 0.11552874, 0.50800995, 0.87025144…
$ Extra_Column_5          &lt;dbl&gt; 0.49814235, 0.42381938, 0.90066981, 0.39035591…
$ Extra_Column_6          &lt;dbl&gt; 0.007901312, 0.083932768, 0.227205241, 0.40318…
$ Extra_Column_7          &lt;dbl&gt; 0.79458257, 0.68895108, 0.49634358, 0.74140891…
$ Extra_Column_8          &lt;dbl&gt; 0.29077922, 0.83016364, 0.75210679, 0.22396813…
$ Extra_Column_9          &lt;dbl&gt; 0.49719307, 0.63449028, 0.18150125, 0.32931387…
$ Extra_Column_10         &lt;dbl&gt; 0.52199452, 0.30204337, 0.62918031, 0.14319054…
$ Extra_Column_11         &lt;dbl&gt; 0.79965663, 0.04368285, 0.01827617, 0.90778075…
$ Extra_Column_12         &lt;dbl&gt; 0.72239788, 0.45166789, 0.06322702, 0.54232201…
$ Extra_Column_13         &lt;dbl&gt; 0.1487387, 0.8786714, 0.1465122, 0.9224606, 0.…
$ Extra_Column_14         &lt;dbl&gt; 0.8340099, 0.5356022, 0.9972962, 0.6262165, 0.…
$ Extra_Column_15         &lt;dbl&gt; 0.061632229, 0.617825340, 0.974455410, 0.22860…</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(heart_attack)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 32
    Age Gender Region Smoking_History Diabetes_History Hypertension_History
  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;            &lt;chr&gt;               
1    56 Male   Urban  Yes             No               No                  
2    69 Male   Urban  No              No               No                  
3    46 Male   Rural  Yes             No               No                  
4    32 Female Urban  No              No               No                  
5    60 Female Rural  No              No               No                  
6    25 Female Rural  No              No               No                  
# ℹ 26 more variables: Cholesterol_Level &lt;dbl&gt;, Physical_Activity &lt;chr&gt;,
#   Diet_Quality &lt;chr&gt;, Alcohol_Consumption &lt;chr&gt;, Stress_Levels &lt;dbl&gt;,
#   BMI &lt;dbl&gt;, Heart_Rate &lt;dbl&gt;, Systolic_BP &lt;dbl&gt;, Diastolic_BP &lt;dbl&gt;,
#   Family_History &lt;chr&gt;, Heart_Attack_Occurrence &lt;chr&gt;, Extra_Column_1 &lt;dbl&gt;,
#   Extra_Column_2 &lt;dbl&gt;, Extra_Column_3 &lt;dbl&gt;, Extra_Column_4 &lt;dbl&gt;,
#   Extra_Column_5 &lt;dbl&gt;, Extra_Column_6 &lt;dbl&gt;, Extra_Column_7 &lt;dbl&gt;,
#   Extra_Column_8 &lt;dbl&gt;, Extra_Column_9 &lt;dbl&gt;, Extra_Column_10 &lt;dbl&gt;, …</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(heart_attack)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Age           Gender             Region          Smoking_History   
 Min.   :18.00   Length:30000       Length:30000       Length:30000      
 1st Qu.:33.00   Class :character   Class :character   Class :character  
 Median :48.00   Mode  :character   Mode  :character   Mode  :character  
 Mean   :48.49                                                           
 3rd Qu.:64.00                                                           
 Max.   :79.00                                                           
 Diabetes_History   Hypertension_History Cholesterol_Level Physical_Activity 
 Length:30000       Length:30000         Min.   : 80.02    Length:30000      
 Class :character   Class :character     1st Qu.:179.55    Class :character  
 Mode  :character   Mode  :character     Median :199.77    Mode  :character  
                                         Mean   :199.90                      
                                         3rd Qu.:220.16                      
                                         Max.   :336.86                      
 Diet_Quality       Alcohol_Consumption Stress_Levels         BMI       
 Length:30000       Length:30000        Min.   : 0.000   Min.   : 5.58  
 Class :character   Class :character    1st Qu.: 3.644   1st Qu.:21.63  
 Mode  :character   Mode  :character    Median : 4.993   Median :24.96  
                                        Mean   : 5.002   Mean   :25.00  
                                        3rd Qu.: 6.353   3rd Qu.:28.36  
                                        Max.   :10.000   Max.   :46.10  
   Heart_Rate      Systolic_BP      Diastolic_BP    Family_History    
 Min.   : 30.03   Min.   : 56.23   Min.   : 39.95   Length:30000      
 1st Qu.: 63.25   1st Qu.:109.79   1st Qu.: 73.26   Class :character  
 Median : 69.95   Median :119.90   Median : 80.12   Mode  :character  
 Mean   : 69.98   Mean   :119.91   Mean   : 80.03                     
 3rd Qu.: 76.66   3rd Qu.:130.02   3rd Qu.: 86.76                     
 Max.   :108.78   Max.   :178.77   Max.   :117.67                     
 Heart_Attack_Occurrence Extra_Column_1      Extra_Column_2     
 Length:30000            Min.   :0.0000071   Min.   :0.0000052  
 Class :character        1st Qu.:0.2533084   1st Qu.:0.2473606  
 Mode  :character        Median :0.5008204   Median :0.4961980  
                         Mean   :0.5019388   Mean   :0.4978940  
                         3rd Qu.:0.7505286   3rd Qu.:0.7473954  
                         Max.   :0.9999654   Max.   :0.9999894  
 Extra_Column_3      Extra_Column_4      Extra_Column_5     
 Min.   :0.0000227   Min.   :0.0000934   Min.   :0.0001051  
 1st Qu.:0.2483093   1st Qu.:0.2522110   1st Qu.:0.2518029  
 Median :0.4976104   Median :0.4976175   Median :0.5019871  
 Mean   :0.4981949   Mean   :0.5005952   Mean   :0.5014100  
 3rd Qu.:0.7476807   3rd Qu.:0.7505662   3rd Qu.:0.7536569  
 Max.   :0.9999694   Max.   :0.9999869   Max.   :0.9999949  
 Extra_Column_6      Extra_Column_7      Extra_Column_8     
 Min.   :0.0000531   Min.   :0.0000678   Min.   :0.0000449  
 1st Qu.:0.2559989   1st Qu.:0.2482839   1st Qu.:0.2509790  
 Median :0.5017726   Median :0.4988157   Median :0.4985698  
 Mean   :0.5027631   Mean   :0.4980753   Mean   :0.5003557  
 3rd Qu.:0.7511886   3rd Qu.:0.7456378   3rd Qu.:0.7507293  
 Max.   :0.9998892   Max.   :0.9999900   Max.   :0.9999300  
 Extra_Column_9      Extra_Column_10     Extra_Column_11    
 Min.   :0.0000305   Min.   :0.0000133   Min.   :0.0000008  
 1st Qu.:0.2502452   1st Qu.:0.2484256   1st Qu.:0.2538092  
 Median :0.4984491   Median :0.5031040   Median :0.5067589  
 Mean   :0.5002292   Mean   :0.5010694   Mean   :0.5044949  
 3rd Qu.:0.7512186   3rd Qu.:0.7522686   3rd Qu.:0.7556257  
 Max.   :0.9999852   Max.   :0.9999928   Max.   :0.9999578  
 Extra_Column_12     Extra_Column_13     Extra_Column_14    
 Min.   :0.0000713   Min.   :0.0000204   Min.   :0.0000025  
 1st Qu.:0.2505341   1st Qu.:0.2473108   1st Qu.:0.2482152  
 Median :0.5038609   Median :0.5041162   Median :0.4943841  
 Mean   :0.5008624   Mean   :0.5004557   Mean   :0.4976507  
 3rd Qu.:0.7511780   3rd Qu.:0.7497094   3rd Qu.:0.7456212  
 Max.   :0.9999484   Max.   :0.9999451   Max.   :0.9999779  
 Extra_Column_15    
 Min.   :0.0000241  
 1st Qu.:0.2482573  
 Median :0.5009406  
 Mean   :0.4999634  
 3rd Qu.:0.7487379  
 Max.   :0.9999913  </code></pre>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>heart_attack[<span class="fu">duplicated</span>(heart_attack),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 32
# ℹ 32 variables: Age &lt;dbl&gt;, Gender &lt;chr&gt;, Region &lt;chr&gt;, Smoking_History &lt;chr&gt;,
#   Diabetes_History &lt;chr&gt;, Hypertension_History &lt;chr&gt;,
#   Cholesterol_Level &lt;dbl&gt;, Physical_Activity &lt;chr&gt;, Diet_Quality &lt;chr&gt;,
#   Alcohol_Consumption &lt;chr&gt;, Stress_Levels &lt;dbl&gt;, BMI &lt;dbl&gt;,
#   Heart_Rate &lt;dbl&gt;, Systolic_BP &lt;dbl&gt;, Diastolic_BP &lt;dbl&gt;,
#   Family_History &lt;chr&gt;, Heart_Attack_Occurrence &lt;chr&gt;, Extra_Column_1 &lt;dbl&gt;,
#   Extra_Column_2 &lt;dbl&gt;, Extra_Column_3 &lt;dbl&gt;, Extra_Column_4 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Ensure that there are no duplicated columns, if not will have to investigate further.</li>
</ul>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(heart_attack))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    Age                  Gender                  Region 
                      0                       0                       0 
        Smoking_History        Diabetes_History    Hypertension_History 
                      0                       0                       0 
      Cholesterol_Level       Physical_Activity            Diet_Quality 
                      0                       0                       0 
    Alcohol_Consumption           Stress_Levels                     BMI 
                      0                       0                       0 
             Heart_Rate             Systolic_BP            Diastolic_BP 
                      0                       0                       0 
         Family_History Heart_Attack_Occurrence          Extra_Column_1 
                      0                       0                       0 
         Extra_Column_2          Extra_Column_3          Extra_Column_4 
                      0                       0                       0 
         Extra_Column_5          Extra_Column_6          Extra_Column_7 
                      0                       0                       0 
         Extra_Column_8          Extra_Column_9         Extra_Column_10 
                      0                       0                       0 
        Extra_Column_11         Extra_Column_12         Extra_Column_13 
                      0                       0                       0 
        Extra_Column_14         Extra_Column_15 
                      0                       0 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Ensure that there are no NA values, if not will have to investigate further.</li>
<li>Possibility to use <code>drop_na()</code> function to drop rows where any specified column contains a missing value.</li>
</ul>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span>(heart_attack)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>cols(
  Age = col_double(),
  Gender = col_character(),
  Region = col_character(),
  Smoking_History = col_character(),
  Diabetes_History = col_character(),
  Hypertension_History = col_character(),
  Cholesterol_Level = col_double(),
  Physical_Activity = col_character(),
  Diet_Quality = col_character(),
  Alcohol_Consumption = col_character(),
  Stress_Levels = col_double(),
  BMI = col_double(),
  Heart_Rate = col_double(),
  Systolic_BP = col_double(),
  Diastolic_BP = col_double(),
  Family_History = col_character(),
  Heart_Attack_Occurrence = col_character(),
  Extra_Column_1 = col_double(),
  Extra_Column_2 = col_double(),
  Extra_Column_3 = col_double(),
  Extra_Column_4 = col_double(),
  Extra_Column_5 = col_double(),
  Extra_Column_6 = col_double(),
  Extra_Column_7 = col_double(),
  Extra_Column_8 = col_double(),
  Extra_Column_9 = col_double(),
  Extra_Column_10 = col_double(),
  Extra_Column_11 = col_double(),
  Extra_Column_12 = col_double(),
  Extra_Column_13 = col_double(),
  Extra_Column_14 = col_double(),
  Extra_Column_15 = col_double()
)</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Ensure that all variables are correctly classified by data type; recast variable types if needed.</li>
<li>Variables are correctly classified - where categorical variables are classified as <strong>character</strong>, while continuous variables are classified as <strong>double</strong>.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>The heart_attack tibble contains 32 attributes, as shown above.</p>
<p>The following preprocessing checks were conducted as part of data preparation:</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preprocessing Checks
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Verified that the correct data types were loaded in the <code>heart_attack</code> dataset using <code>glimpse()</code> and <code>spec()</code></li>
<li>Ensured there were no duplicate variable names using <code>duplicated()</code> in the dataset</li>
<li>Checked for missing values using <code>colSums(is.na())</code></li>
</ul>
</div>
</div>
</section>
<section id="understanding-the-metadata" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-metadata">3.2 Understanding the metadata</h3>
<p>The table below presents the metadata for the dataset, classifying each variable as either categorical or continuous based on its nature and data type.</p>
<ul>
<li><p><strong>Categorical attributes:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 11%">
<col style="width: 65%">
</colgroup>
<thead>
<tr class="header">
<th>Variable Names</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Gender</td>
<td>CHAR</td>
<td>Biological sex of the individual (e.g., Male, Female)</td>
</tr>
<tr class="even">
<td>Region</td>
<td>CHAR</td>
<td>Geographic location where the individual resides (e.g., Urban, Rural)</td>
</tr>
<tr class="odd">
<td>Smoking_History</td>
<td>CHAR</td>
<td>Past or current smoking habits (e.g., Yes, No)</td>
</tr>
<tr class="even">
<td>Diabetes_History</td>
<td>CHAR</td>
<td>History of diabetes diagnosis (Yes/No)</td>
</tr>
<tr class="odd">
<td>Hypertension_History</td>
<td>CHAR</td>
<td>History of high blood pressure diagnosis (Yes/No)</td>
</tr>
<tr class="even">
<td>Physical_Activity</td>
<td>CHAR</td>
<td>Level of physical activity (e.g., Low, Moderate, High)</td>
</tr>
<tr class="odd">
<td>Diet_Quality</td>
<td>CHAR</td>
<td>Dietary habits and nutritional intake assessment (e.g., Poor, Average, Good)</td>
</tr>
<tr class="even">
<td>Alcohol_Consumption</td>
<td>CHAR</td>
<td>Frequency or amount of alcohol intake (e.g., Low, Moderate, High, None)</td>
</tr>
<tr class="odd">
<td>Family_History</td>
<td>CHAR</td>
<td>Presence of heart disease in close relatives (Yes/No)</td>
</tr>
<tr class="even">
<td>Heart_Attack_Occurrence</td>
<td>CHAR</td>
<td>Whether the individual has experienced a heart attack (Yes/No)</td>
</tr>
</tbody>
</table></li>
<li><p><strong>Continuous attributes:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 16%">
<col style="width: 59%">
</colgroup>
<thead>
<tr class="header">
<th>Variable Names</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Age</td>
<td>NUM</td>
<td>Age of the individual in years</td>
</tr>
<tr class="even">
<td>Cholesterol_Level</td>
<td>NUM</td>
<td>Measured cholesterol level in the blood</td>
</tr>
<tr class="odd">
<td>Stress_Levels</td>
<td>NUM</td>
<td>Measured or self-reported stress level</td>
</tr>
<tr class="even">
<td>BMI</td>
<td>NUM</td>
<td>Body Mass Index, calculated from height and weight</td>
</tr>
<tr class="odd">
<td>Heart_Rate</td>
<td>NUM</td>
<td>Resting heart rate in beats per minute (bpm)</td>
</tr>
<tr class="even">
<td>Systolic_BP</td>
<td>NUM</td>
<td>Systolic blood pressure measurement (mmHg)</td>
</tr>
<tr class="odd">
<td>Diastolic_BP</td>
<td>NUM</td>
<td>Diastolic blood pressure measurement (mmHg)</td>
</tr>
<tr class="even">
<td>Extra_Column_1</td>
<td>NUM</td>
<td></td>
</tr>
<tr class="odd">
<td>Extra_Column_2</td>
<td>NUM</td>
<td></td>
</tr>
<tr class="even">
<td>Extra_Column_3</td>
<td>NUM</td>
<td></td>
</tr>
<tr class="odd">
<td>Extra_Column_4</td>
<td>NUM</td>
<td></td>
</tr>
<tr class="even">
<td>Extra_Column_5</td>
<td>NUM</td>
<td></td>
</tr>
<tr class="odd">
<td>Extra_Column_6</td>
<td>NUM</td>
<td></td>
</tr>
<tr class="even">
<td>Extra_Column_7</td>
<td>NUM</td>
<td></td>
</tr>
<tr class="odd">
<td>Extra_Column_8</td>
<td>NUM</td>
<td></td>
</tr>
<tr class="even">
<td>Extra_Column_9</td>
<td>NUM</td>
<td></td>
</tr>
<tr class="odd">
<td>Extra_Column_10</td>
<td>NUM</td>
<td></td>
</tr>
<tr class="even">
<td>Extra_Column_11</td>
<td>NUM</td>
<td></td>
</tr>
<tr class="odd">
<td>Extra_Column_12</td>
<td>NUM</td>
<td></td>
</tr>
<tr class="even">
<td>Extra_Column_13</td>
<td>NUM</td>
<td></td>
</tr>
<tr class="odd">
<td>Extra_Column_14</td>
<td>NUM</td>
<td></td>
</tr>
<tr class="even">
<td>Extra_Column_15</td>
<td>NUM</td>
<td></td>
</tr>
</tbody>
</table></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Notice that Extra_Column_1 to Extra_Column_15 are additional numeric figures without clear definition.</li>
<li>They are most likely derived calculations from the variables.</li>
</ul>
</div>
</div>
</section>
<section id="filtering-for-relevant-variables" class="level3">
<h3 class="anchored" data-anchor-id="filtering-for-relevant-variables">3.3 Filtering for relevant variables</h3>
<p>Of the 32 variables (columns), only 17 variables(columns) are selected for analysis</p>
<ul>
<li>All columns are selected except for Extra_Column_1 to Extra_Column_15</li>
</ul>
<p>The <code>select()</code> function in the <a href="https://www.rdocumentation.org/packages/dplyr/versions/0.5.0">dplyr</a> package is used to obtain these rows, and stored as the R object, <code>heart_attack_1</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>heart_attack_1 <span class="ot">&lt;-</span> heart_attack <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"Age"</span>, <span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Smoking_History"</span>, <span class="st">"Diabetes_History"</span>, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Hypertension_History"</span>, <span class="st">"Cholesterol_Level"</span>, <span class="st">"Physical_Activity"</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Diet_Quality"</span>, <span class="st">"Alcohol_Consumption"</span>, <span class="st">"Stress_Levels"</span>, <span class="st">"BMI"</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Heart_Rate"</span>, <span class="st">"Systolic_BP"</span>, <span class="st">"Diastolic_BP"</span>, <span class="st">"Family_History"</span>, </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Heart_Attack_Occurrence"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>heart_attack_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30,000 × 17
     Age Gender Region Smoking_History Diabetes_History Hypertension_History
   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;            &lt;chr&gt;               
 1    56 Male   Urban  Yes             No               No                  
 2    69 Male   Urban  No              No               No                  
 3    46 Male   Rural  Yes             No               No                  
 4    32 Female Urban  No              No               No                  
 5    60 Female Rural  No              No               No                  
 6    25 Female Rural  No              No               No                  
 7    78 Male   Urban  No              Yes              Yes                 
 8    38 Female Urban  Yes             No               No                  
 9    56 Male   Rural  No              No               Yes                 
10    75 Male   Urban  No              No               No                  
# ℹ 29,990 more rows
# ℹ 11 more variables: Cholesterol_Level &lt;dbl&gt;, Physical_Activity &lt;chr&gt;,
#   Diet_Quality &lt;chr&gt;, Alcohol_Consumption &lt;chr&gt;, Stress_Levels &lt;dbl&gt;,
#   BMI &lt;dbl&gt;, Heart_Rate &lt;dbl&gt;, Systolic_BP &lt;dbl&gt;, Diastolic_BP &lt;dbl&gt;,
#   Family_History &lt;chr&gt;, Heart_Attack_Occurrence &lt;chr&gt;</code></pre>
</div>
</div>
<p>The output shows a tibble dataframe with 30,000 rows and 17 columns.</p>
</section>
<section id="recoding-and-creating-of-new-variables" class="level3">
<h3 class="anchored" data-anchor-id="recoding-and-creating-of-new-variables">3.5 Recoding and creating of new variables</h3>
<section id="recoding-continuous-variables-into-categorical-variables" class="level4">
<h4 class="anchored" data-anchor-id="recoding-continuous-variables-into-categorical-variables">3.5.1 Recoding continuous variables into categorical variables</h4>
<p>In the following section, we will recode specific continuous variables into categorical groups for better interpretability. While variables like <em>Cholesterol_Level</em>, <em>Stress_Levels</em>, <em>BMI</em>, <em>Heart_Rate</em>, <em>Systolic_BP</em>, and <em>Diastolic_BP</em> provide valuable insights in their continuous form, categorizing them into meaningful groups will enhance our ability to analyze trends and risk factors more effectively.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 69%">
</colgroup>
<thead>
<tr class="header">
<th>Variable Names</th>
<th>Measurement</th>
<th>Categorical ranges <span style="font-size: 10px;"><em>Approximated classification based on best effort</em></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cholesterol_Level</td>
<td>mg/dL</td>
<td><ul>
<li><strong>Low:</strong> ≤ 150</li>
<li><strong>Moderate:</strong> 151–200</li>
<li><strong>High:</strong> &gt; 200</li>
</ul></td>
</tr>
<tr class="even">
<td>Stress_Levels</td>
<td>Self-reported scale</td>
<td><ul>
<li><strong>Miniminal Stress:</strong> 0 |</li>
<li><strong>Low Stress:</strong> 1–3</li>
<li><strong>Moderate Stress:</strong> 4–7</li>
<li><strong>High Stress:</strong> 8–10</li>
</ul></td>
</tr>
<tr class="odd">
<td>BMI</td>
<td>Body Mass Index</td>
<td><ul>
<li><strong>Underweight:</strong> &lt; 18.5</li>
<li><strong>Normal Weight:</strong> 18.5–24.9</li>
<li><strong>Overweight:</strong> 25–29.9</li>
<li><strong>Obese:</strong> ≥ 30</li>
</ul></td>
</tr>
<tr class="even">
<td>Heart_Rate</td>
<td>beats per minute</td>
<td><ul>
<li><strong>Bradycardia (Low):</strong> &lt; 60</li>
<li><strong>Normal:</strong> 60–100</li>
<li><strong>Tachycardia (High):</strong> &gt; 100</li>
</ul></td>
</tr>
<tr class="odd">
<td>Systolic_BP</td>
<td>mmHg</td>
<td><ul>
<li><strong>Normal:</strong> &lt; 120</li>
<li><strong>Elevated:</strong> 120–129</li>
<li><strong>Hypertension Stage 1:</strong> 130–139</li>
<li><strong>Hypertension Stage 2:</strong> ≥ 140</li>
</ul></td>
</tr>
<tr class="even">
<td>Diastolic_BP</td>
<td>mmHg</td>
<td><ul>
<li><strong>Normal:</strong> &lt; 80</li>
<li><strong>Elevated:</strong> 80–89</li>
<li><strong>Hypertension Stage 1:</strong> 90–99</li>
<li><strong>Hypertension Stage 2:</strong> ≥ 100</li>
</ul></td>
</tr>
</tbody>
</table>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>heart_attack_1 <span class="ot">&lt;-</span> heart_attack <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"Age"</span>, <span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Smoking_History"</span>, <span class="st">"Diabetes_History"</span>, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Hypertension_History"</span>, <span class="st">"Cholesterol_Level"</span>, <span class="st">"Physical_Activity"</span>, </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Diet_Quality"</span>, <span class="st">"Alcohol_Consumption"</span>, <span class="st">"Stress_Levels"</span>, <span class="st">"BMI"</span>, </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Heart_Rate"</span>, <span class="st">"Systolic_BP"</span>, <span class="st">"Diastolic_BP"</span>, <span class="st">"Family_History"</span>, </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Heart_Attack_Occurrence"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cholesterol_Level_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>      Cholesterol_Level <span class="sc">&lt;=</span> <span class="dv">150</span> <span class="sc">~</span> <span class="st">"Low"</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>      Cholesterol_Level <span class="sc">&lt;=</span> <span class="dv">200</span> <span class="sc">~</span> <span class="st">"Moderate"</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"High"</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># **ROUND Stress_Levels before categorization**</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rounded_Stress_Levels =</span> <span class="fu">round</span>(Stress_Levels), </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Stress_Levels_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(Rounded_Stress_Levels) <span class="sc">~</span> <span class="st">"Unknown"</span>,  <span class="co"># Handle missing values</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>      Rounded_Stress_Levels <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Minimal Stress"</span>,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>      Rounded_Stress_Levels <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">~</span> <span class="st">"Low Stress"</span>,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>      Rounded_Stress_Levels <span class="sc">%in%</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">7</span> <span class="sc">~</span> <span class="st">"Moderate Stress"</span>,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>      Rounded_Stress_Levels <span class="sc">%in%</span> <span class="dv">8</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">~</span> <span class="st">"High Stress"</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">BMI_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>      BMI <span class="sc">&lt;</span> <span class="fl">18.5</span> <span class="sc">~</span> <span class="st">"Underweight"</span>,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>      BMI <span class="sc">&gt;=</span> <span class="fl">18.5</span> <span class="sc">&amp;</span> BMI <span class="sc">&lt;</span> <span class="dv">25</span> <span class="sc">~</span> <span class="st">"Normal Weight"</span>,</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>      BMI <span class="sc">&gt;=</span> <span class="dv">25</span> <span class="sc">&amp;</span> BMI <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"Overweight"</span>,</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>      BMI <span class="sc">&gt;=</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"Obese"</span>,</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">Heart_Rate_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>      Heart_Rate <span class="sc">&lt;</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"Bradycardia (Low)"</span>,</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>      Heart_Rate <span class="sc">&gt;=</span> <span class="dv">60</span> <span class="sc">&amp;</span> Heart_Rate <span class="sc">&lt;=</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>      Heart_Rate <span class="sc">&gt;</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"Tachycardia (High)"</span>,</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">Systolic_BP_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>      Systolic_BP <span class="sc">&lt;</span> <span class="dv">120</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>      Systolic_BP <span class="sc">&gt;=</span> <span class="dv">120</span> <span class="sc">&amp;</span> Systolic_BP <span class="sc">&lt;</span> <span class="dv">130</span> <span class="sc">~</span> <span class="st">"Elevated"</span>,</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>      Systolic_BP <span class="sc">&gt;=</span> <span class="dv">130</span> <span class="sc">&amp;</span> Systolic_BP <span class="sc">&lt;</span> <span class="dv">140</span> <span class="sc">~</span> <span class="st">"Hypertension Stage 1"</span>,</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>      Systolic_BP <span class="sc">&gt;=</span> <span class="dv">140</span> <span class="sc">~</span> <span class="st">"Hypertension Stage 2"</span>,</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">Diastolic_BP_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>      Diastolic_BP <span class="sc">&lt;</span> <span class="dv">80</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>      Diastolic_BP <span class="sc">&gt;=</span> <span class="dv">80</span> <span class="sc">&amp;</span> Diastolic_BP <span class="sc">&lt;</span> <span class="dv">90</span> <span class="sc">~</span> <span class="st">"Elevated"</span>,</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>      Diastolic_BP <span class="sc">&gt;=</span> <span class="dv">90</span> <span class="sc">&amp;</span> Diastolic_BP <span class="sc">&lt;</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"Hypertension Stage 1"</span>,</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>      Diastolic_BP <span class="sc">&gt;=</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"Hypertension Stage 2"</span>,</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a><span class="co"># View the modified dataframe with new categorical variables</span></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>heart_attack_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30,000 × 24
     Age Gender Region Smoking_History Diabetes_History Hypertension_History
   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;            &lt;chr&gt;               
 1    56 Male   Urban  Yes             No               No                  
 2    69 Male   Urban  No              No               No                  
 3    46 Male   Rural  Yes             No               No                  
 4    32 Female Urban  No              No               No                  
 5    60 Female Rural  No              No               No                  
 6    25 Female Rural  No              No               No                  
 7    78 Male   Urban  No              Yes              Yes                 
 8    38 Female Urban  Yes             No               No                  
 9    56 Male   Rural  No              No               Yes                 
10    75 Male   Urban  No              No               No                  
# ℹ 29,990 more rows
# ℹ 18 more variables: Cholesterol_Level &lt;dbl&gt;, Physical_Activity &lt;chr&gt;,
#   Diet_Quality &lt;chr&gt;, Alcohol_Consumption &lt;chr&gt;, Stress_Levels &lt;dbl&gt;,
#   BMI &lt;dbl&gt;, Heart_Rate &lt;dbl&gt;, Systolic_BP &lt;dbl&gt;, Diastolic_BP &lt;dbl&gt;,
#   Family_History &lt;chr&gt;, Heart_Attack_Occurrence &lt;chr&gt;,
#   Cholesterol_Level_Category &lt;chr&gt;, Rounded_Stress_Levels &lt;dbl&gt;,
#   Stress_Levels_Category &lt;chr&gt;, BMI_Category &lt;chr&gt;, …</code></pre>
</div>
</div>
</section>
<section id="recoding-age-into-categorical-variable" class="level4">
<h4 class="anchored" data-anchor-id="recoding-age-into-categorical-variable">3.5.2 Recoding <code>age</code> into categorical variable</h4>
<p>While analyzing age as a continuous variable provides detailed insights, categorizing the <code>Age</code> variable into distinct age groups allows us to explore how age influences the likelihood of heart attack incidents.</p>
<p>The table below are the proposed age categories for this analysis:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Categories</th>
<th>Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Youth</td>
<td>≤25 years</td>
</tr>
<tr class="even">
<td>Young adults</td>
<td>26–40 years</td>
</tr>
<tr class="odd">
<td>Middle-aged adults</td>
<td>41–55 years</td>
</tr>
<tr class="even">
<td>Older adults</td>
<td>56–70 years</td>
</tr>
<tr class="odd">
<td>Elderly</td>
<td>≥71 years</td>
</tr>
</tbody>
</table>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>heart_attack_2 <span class="ot">&lt;-</span> heart_attack_1 <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>      Age <span class="sc">&lt;=</span> <span class="dv">25</span> <span class="sc">~</span> <span class="st">"Youth"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>      Age <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;=</span> <span class="dv">40</span> <span class="sc">~</span> <span class="st">"Young Adult"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>      Age <span class="sc">&gt;=</span> <span class="dv">41</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;=</span> <span class="dv">55</span> <span class="sc">~</span> <span class="st">"Middle-Aged Adult"</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>      Age <span class="sc">&gt;=</span> <span class="dv">56</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;=</span> <span class="dv">70</span> <span class="sc">~</span> <span class="st">"Older Adult"</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>      Age <span class="sc">&gt;=</span> <span class="dv">71</span> <span class="sc">~</span> <span class="st">"Elderly"</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># View the updated dataset</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>heart_attack_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30,000 × 25
     Age Gender Region Smoking_History Diabetes_History Hypertension_History
   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;            &lt;chr&gt;               
 1    56 Male   Urban  Yes             No               No                  
 2    69 Male   Urban  No              No               No                  
 3    46 Male   Rural  Yes             No               No                  
 4    32 Female Urban  No              No               No                  
 5    60 Female Rural  No              No               No                  
 6    25 Female Rural  No              No               No                  
 7    78 Male   Urban  No              Yes              Yes                 
 8    38 Female Urban  Yes             No               No                  
 9    56 Male   Rural  No              No               Yes                 
10    75 Male   Urban  No              No               No                  
# ℹ 29,990 more rows
# ℹ 19 more variables: Cholesterol_Level &lt;dbl&gt;, Physical_Activity &lt;chr&gt;,
#   Diet_Quality &lt;chr&gt;, Alcohol_Consumption &lt;chr&gt;, Stress_Levels &lt;dbl&gt;,
#   BMI &lt;dbl&gt;, Heart_Rate &lt;dbl&gt;, Systolic_BP &lt;dbl&gt;, Diastolic_BP &lt;dbl&gt;,
#   Family_History &lt;chr&gt;, Heart_Attack_Occurrence &lt;chr&gt;,
#   Cholesterol_Level_Category &lt;chr&gt;, Rounded_Stress_Levels &lt;dbl&gt;,
#   Stress_Levels_Category &lt;chr&gt;, BMI_Category &lt;chr&gt;, …</code></pre>
</div>
</div>
</section>
<section id="checking-the-data-structure-after-filtering-and-recoding-of-variables" class="level4">
<h4 class="anchored" data-anchor-id="checking-the-data-structure-after-filtering-and-recoding-of-variables">3.5.3 Checking the data structure after filtering and recoding of variables</h4>
<p>We will re-check the dataset after filtering and recoding of continuous variables using below:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">glimpse()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">head()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">summary()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">duplicated()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">colSum(is.na())</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">spec())</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(heart_attack_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 30,000
Columns: 25
$ Age                        &lt;dbl&gt; 56, 69, 46, 32, 60, 25, 78, 38, 56, 75, 36,…
$ Gender                     &lt;chr&gt; "Male", "Male", "Male", "Female", "Female",…
$ Region                     &lt;chr&gt; "Urban", "Urban", "Rural", "Urban", "Rural"…
$ Smoking_History            &lt;chr&gt; "Yes", "No", "Yes", "No", "No", "No", "No",…
$ Diabetes_History           &lt;chr&gt; "No", "No", "No", "No", "No", "No", "Yes", …
$ Hypertension_History       &lt;chr&gt; "No", "No", "No", "No", "No", "No", "Yes", …
$ Cholesterol_Level          &lt;dbl&gt; 186.4002, 185.1367, 210.6966, 211.1655, 223…
$ Physical_Activity          &lt;chr&gt; "Moderate", "Low", "Low", "Moderate", "High…
$ Diet_Quality               &lt;chr&gt; "Poor", "Good", "Average", "Good", "Good", …
$ Alcohol_Consumption        &lt;chr&gt; "Low", "Low", "Moderate", "High", "High", "…
$ Stress_Levels              &lt;dbl&gt; 3.644786, 3.384056, 3.810911, 6.014878, 6.8…
$ BMI                        &lt;dbl&gt; 33.96135, 28.24287, 27.60121, 23.71729, 19.…
$ Heart_Rate                 &lt;dbl&gt; 72.30153, 57.45764, 64.65870, 55.13147, 76.…
$ Systolic_BP                &lt;dbl&gt; 123.90209, 129.89331, 145.65490, 131.78522,…
$ Diastolic_BP               &lt;dbl&gt; 85.68281, 73.52426, 71.99481, 68.21133, 92.…
$ Family_History             &lt;chr&gt; "No", "Yes", "No", "No", "No", "No", "No", …
$ Heart_Attack_Occurrence    &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "…
$ Cholesterol_Level_Category &lt;chr&gt; "Moderate", "Moderate", "High", "High", "Hi…
$ Rounded_Stress_Levels      &lt;dbl&gt; 4, 3, 4, 6, 7, 8, 5, 5, 7, 4, 3, 2, 2, 3, 8…
$ Stress_Levels_Category     &lt;chr&gt; "Moderate Stress", "Low Stress", "Moderate …
$ BMI_Category               &lt;chr&gt; "Obese", "Overweight", "Overweight", "Norma…
$ Heart_Rate_Category        &lt;chr&gt; "Normal", "Bradycardia (Low)", "Normal", "B…
$ Systolic_BP_Category       &lt;chr&gt; "Elevated", "Elevated", "Hypertension Stage…
$ Diastolic_BP_Category      &lt;chr&gt; "Elevated", "Normal", "Normal", "Normal", "…
$ Age_Category               &lt;chr&gt; "Older Adult", "Older Adult", "Middle-Aged …</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(heart_attack_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 25
    Age Gender Region Smoking_History Diabetes_History Hypertension_History
  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;            &lt;chr&gt;               
1    56 Male   Urban  Yes             No               No                  
2    69 Male   Urban  No              No               No                  
3    46 Male   Rural  Yes             No               No                  
4    32 Female Urban  No              No               No                  
5    60 Female Rural  No              No               No                  
6    25 Female Rural  No              No               No                  
# ℹ 19 more variables: Cholesterol_Level &lt;dbl&gt;, Physical_Activity &lt;chr&gt;,
#   Diet_Quality &lt;chr&gt;, Alcohol_Consumption &lt;chr&gt;, Stress_Levels &lt;dbl&gt;,
#   BMI &lt;dbl&gt;, Heart_Rate &lt;dbl&gt;, Systolic_BP &lt;dbl&gt;, Diastolic_BP &lt;dbl&gt;,
#   Family_History &lt;chr&gt;, Heart_Attack_Occurrence &lt;chr&gt;,
#   Cholesterol_Level_Category &lt;chr&gt;, Rounded_Stress_Levels &lt;dbl&gt;,
#   Stress_Levels_Category &lt;chr&gt;, BMI_Category &lt;chr&gt;,
#   Heart_Rate_Category &lt;chr&gt;, Systolic_BP_Category &lt;chr&gt;, …</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(heart_attack_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Age           Gender             Region          Smoking_History   
 Min.   :18.00   Length:30000       Length:30000       Length:30000      
 1st Qu.:33.00   Class :character   Class :character   Class :character  
 Median :48.00   Mode  :character   Mode  :character   Mode  :character  
 Mean   :48.49                                                           
 3rd Qu.:64.00                                                           
 Max.   :79.00                                                           
 Diabetes_History   Hypertension_History Cholesterol_Level Physical_Activity 
 Length:30000       Length:30000         Min.   : 80.02    Length:30000      
 Class :character   Class :character     1st Qu.:179.55    Class :character  
 Mode  :character   Mode  :character     Median :199.77    Mode  :character  
                                         Mean   :199.90                      
                                         3rd Qu.:220.16                      
                                         Max.   :336.86                      
 Diet_Quality       Alcohol_Consumption Stress_Levels         BMI       
 Length:30000       Length:30000        Min.   : 0.000   Min.   : 5.58  
 Class :character   Class :character    1st Qu.: 3.644   1st Qu.:21.63  
 Mode  :character   Mode  :character    Median : 4.993   Median :24.96  
                                        Mean   : 5.002   Mean   :25.00  
                                        3rd Qu.: 6.353   3rd Qu.:28.36  
                                        Max.   :10.000   Max.   :46.10  
   Heart_Rate      Systolic_BP      Diastolic_BP    Family_History    
 Min.   : 30.03   Min.   : 56.23   Min.   : 39.95   Length:30000      
 1st Qu.: 63.25   1st Qu.:109.79   1st Qu.: 73.26   Class :character  
 Median : 69.95   Median :119.90   Median : 80.12   Mode  :character  
 Mean   : 69.98   Mean   :119.91   Mean   : 80.03                     
 3rd Qu.: 76.66   3rd Qu.:130.02   3rd Qu.: 86.76                     
 Max.   :108.78   Max.   :178.77   Max.   :117.67                     
 Heart_Attack_Occurrence Cholesterol_Level_Category Rounded_Stress_Levels
 Length:30000            Length:30000               Min.   : 0.000       
 Class :character        Class :character           1st Qu.: 4.000       
 Mode  :character        Mode  :character           Median : 5.000       
                                                    Mean   : 4.998       
                                                    3rd Qu.: 6.000       
                                                    Max.   :10.000       
 Stress_Levels_Category BMI_Category       Heart_Rate_Category
 Length:30000           Length:30000       Length:30000       
 Class :character       Class :character   Class :character   
 Mode  :character       Mode  :character   Mode  :character   
                                                              
                                                              
                                                              
 Systolic_BP_Category Diastolic_BP_Category Age_Category      
 Length:30000         Length:30000          Length:30000      
 Class :character     Class :character      Class :character  
 Mode  :character     Mode  :character      Mode  :character  
                                                              
                                                              
                                                              </code></pre>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>heart_attack_2[<span class="fu">duplicated</span>(heart_attack_2),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 25
# ℹ 25 variables: Age &lt;dbl&gt;, Gender &lt;chr&gt;, Region &lt;chr&gt;, Smoking_History &lt;chr&gt;,
#   Diabetes_History &lt;chr&gt;, Hypertension_History &lt;chr&gt;,
#   Cholesterol_Level &lt;dbl&gt;, Physical_Activity &lt;chr&gt;, Diet_Quality &lt;chr&gt;,
#   Alcohol_Consumption &lt;chr&gt;, Stress_Levels &lt;dbl&gt;, BMI &lt;dbl&gt;,
#   Heart_Rate &lt;dbl&gt;, Systolic_BP &lt;dbl&gt;, Diastolic_BP &lt;dbl&gt;,
#   Family_History &lt;chr&gt;, Heart_Attack_Occurrence &lt;chr&gt;,
#   Cholesterol_Level_Category &lt;chr&gt;, Rounded_Stress_Levels &lt;dbl&gt;, …</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Ensure that there are no duplicated columns, if not will have to investigate further.</li>
</ul>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(heart_attack_2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                       Age                     Gender 
                         0                          0 
                    Region            Smoking_History 
                         0                          0 
          Diabetes_History       Hypertension_History 
                         0                          0 
         Cholesterol_Level          Physical_Activity 
                         0                          0 
              Diet_Quality        Alcohol_Consumption 
                         0                          0 
             Stress_Levels                        BMI 
                         0                          0 
                Heart_Rate                Systolic_BP 
                         0                          0 
              Diastolic_BP             Family_History 
                         0                          0 
   Heart_Attack_Occurrence Cholesterol_Level_Category 
                         0                          0 
     Rounded_Stress_Levels     Stress_Levels_Category 
                         0                          0 
              BMI_Category        Heart_Rate_Category 
                         0                          0 
      Systolic_BP_Category      Diastolic_BP_Category 
                         0                          0 
              Age_Category 
                         0 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Ensure that there are no NA values, if not will have to investigate further.</li>
<li>Possibility to use <code>drop_na()</code> function to drop rows where any specified column contains a missing value.</li>
</ul>
</div>
</div>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span>(heart_attack_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Ensure that all variables are correctly classified by data type; recast variable types if needed.</li>
<li>Variables are correctly classified - where categorical variables are classified as <strong>character</strong>, while continuous variables are classified as <strong>double</strong>.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preprocessing Checks
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Verified that the correct data types were loaded in the <code>heart_attack</code> dataset using <code>glimpse()</code> and <code>spec()</code></li>
<li>Ensured there were no duplicate variable names using <code>duplicated()</code> in the dataset</li>
<li>Checked for missing values using <code>colSums(is.na())</code></li>
</ul>
</div>
</div>
<p>The final output - <code>heart_attack_2</code> shows a tibble dataframe with 30,000 rows and 17 columns.</p>
</section>
</section>
<section id="exploratory-data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis">3.6 Exploratory Data Analysis</h3>
<section id="eda-0---check-for-potential-bias-in-data-collection" class="level4">
<h4 class="anchored" data-anchor-id="eda-0---check-for-potential-bias-in-data-collection">3.6.1 EDA 0 - check for potential bias in data collection</h4>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Key observations</strong></p>
<ul>
<li><strong>Uneven representation of age groups</strong>
<ul>
<li>Noticeably lower number of Youth (≤25 years) and Elderly (≥71 years) compared to the middle age groups</li>
<li>Young adults (26–40 years), middle-aged adults (41–55 years), and older adults (56–70 years) make up the majority of the dataset</li>
</ul></li>
<li><strong>Potential bias in data collection</strong>
<ul>
<li><p>Underrepresentation of elderly individuals might inflate their heart attack rate in percentage-based analyses</p></li>
<li><p>Low count of youth suggests they may be under-sampled</p></li>
</ul></li>
</ul>
<p><strong>What can we do:</strong></p>
<ul>
<li>In the future, ensure that the data collected are proportionally across all age groups</li>
<li>Check for potential sampling bias</li>
<li>Normalize the heart attack rates based on the total population for each age group</li>
</ul>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Absolute age count()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Visualization: Absolute age count()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Count by Age_Category()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">Visualization: Age_Category()</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of individuals by exact age</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>age_distribution <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Age)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print age count</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(age_distribution)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 62 × 2
     Age Count
   &lt;dbl&gt; &lt;int&gt;
 1    18   478
 2    19   480
 3    20   483
 4    21   483
 5    22   468
 6    23   462
 7    24   466
 8    25   493
 9    26   480
10    27   493
# ℹ 52 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(age_distribution, <span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Count)) <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#78B3EA"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Age Distribution of Individuals in Dataset"</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age"</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Individuals"</span>) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define age category levels in the required order</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>age_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Youth (≤25 years)"</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Young adults (26–40 years)"</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Older adults (56–70 years)"</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Middle-aged adults (41–55 years)"</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Elderly (≥71 years)"</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Count individuals by Age Category with ordered factor levels</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>age_category_distribution <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">&lt;=</span> <span class="dv">25</span> <span class="sc">~</span> <span class="st">"Youth (≤25 years)"</span>,</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;=</span> <span class="dv">40</span> <span class="sc">~</span> <span class="st">"Young adults (26–40 years)"</span>,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">&gt;=</span> <span class="dv">41</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;=</span> <span class="dv">55</span> <span class="sc">~</span> <span class="st">"Middle-aged adults (41–55 years)"</span>,</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">&gt;=</span> <span class="dv">56</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;=</span> <span class="dv">70</span> <span class="sc">~</span> <span class="st">"Older adults (56–70 years)"</span>,</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">&gt;=</span> <span class="dv">71</span> <span class="sc">~</span> <span class="st">"Elderly (≥71 years)"</span>,</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Category) <span class="sc">%&gt;%</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Category =</span> <span class="fu">factor</span>(Age_Category, <span class="at">levels =</span> age_levels)) <span class="sc">%&gt;%</span>  <span class="co"># Apply custom sorting</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Age_Category)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Print age category count</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(age_category_distribution)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  Age_Category                     Count
  &lt;fct&gt;                            &lt;int&gt;
1 Youth (≤25 years)                 3813
2 Young adults (26–40 years)        7432
3 Older adults (56–70 years)        7201
4 Middle-aged adults (41–55 years)  7153
5 Elderly (≥71 years)               4401</code></pre>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization: Age Category Distribution</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(age_category_distribution, <span class="fu">aes</span>(<span class="at">x =</span> Age_Category, <span class="at">y =</span> Count, <span class="at">fill =</span> Age_Category)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add text labels above bars</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Count), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Age Category Distribution in Dataset"</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Category"</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Individuals"</span>) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="eda-1---explore-how-age-influences-the-likelihood-of-heart-attack-incidents" class="level4">
<h4 class="anchored" data-anchor-id="eda-1---explore-how-age-influences-the-likelihood-of-heart-attack-incidents">3.6.2 EDA 1 - explore how age influences the likelihood of heart attack incidents</h4>
<section id="age-distribution-of-heart-attack-patients---histogram" class="level5">
<h5 class="anchored" data-anchor-id="age-distribution-of-heart-attack-patients---histogram">3.6.2.1 Age distribution of heart attack patients - histogram</h5>
<p>Observations:</p>
<ul>
<li><strong>Heart attacks occur across all ages:</strong>
<ul>
<li>Histogram shows a wide distribution of heart attack patients across various age groups</li>
</ul></li>
<li><strong>Age group variation in heart attack rates:</strong>
<ul>
<li>Heart attack rate appears to be relatively stable across most age bins, ranging between 8.6% to 11.3%.</li>
<li>Highest normalized heart attack rate is in the [73,78] age bin (~11.3%).</li>
</ul></li>
<li><strong>Gradual increase in heart attack rates:</strong>
<ul>
<li>Gradual increase in heart attack rates between younger groups [18,23] to middle-aged adults [38,43]</li>
</ul></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Code()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Graph()</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The <code>cut()</code>function was used to divide a continuous variable (like Age) into discrete intervals such as bins.</li>
<li><code>cut()</code> function is part of Base R, which does not require any additional packages to use.</li>
</ul>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Remove any NA values in Age before binning</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>heart_attack_2 <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Age)) <span class="sc">%&gt;%</span>  <span class="co"># Remove missing Age values</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Bin =</span> <span class="fu">cut</span>(Age, </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">floor</span>(<span class="fu">min</span>(Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">ceiling</span>(<span class="fu">max</span>(Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span> <span class="dv">5</span>,  </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">by =</span> <span class="dv">5</span>), </span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">right =</span> <span class="cn">FALSE</span>))  </span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Count total individuals per age bin</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>total_population <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Bin) <span class="sc">%&gt;%</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total_Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Count heart attack occurrences per age bin</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>heart_attack_counts <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Bin) <span class="sc">%&gt;%</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Heart_Attack_Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Merge the two tables and replace NA values with 0</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>normalized_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(total_population, heart_attack_counts, <span class="at">by =</span> <span class="st">"Age_Bin"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Heart_Attack_Count =</span> <span class="fu">replace_na</span>(Heart_Attack_Count, <span class="dv">0</span>),  <span class="co"># Replace NA counts with 0</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">Normalized_Heart_Attack_Rate =</span> (Heart_Attack_Count <span class="sc">/</span> Total_Count) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Age_Bin))  <span class="co"># Ensure Age_Bin does not contain NA values</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Create the normalized histogram</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normalized_data, <span class="fu">aes</span>(<span class="at">x =</span> Age_Bin, <span class="at">y =</span> Normalized_Heart_Attack_Rate, <span class="at">fill =</span> Age_Bin)) <span class="sc">+</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add text labels showing the percentage per bin</span></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Normalized_Heart_Attack_Rate)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normalized Age Distribution of Heart Attack Patients"</span>,</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Groups (Binned by 5 Years)"</span>,</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Heart Attack Rate (Normalized, % of total in group)"</span>) <span class="sc">+</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="heart-attack-rate-by-age-group---histogram" class="level5">
<h5 class="anchored" data-anchor-id="heart-attack-rate-by-age-group---histogram">3.6.2.2 Heart attack rate by age group - histogram</h5>
<p>Another point of view, categorizing ages into groups and calculating the heart attack rate for each group.</p>
<p>Observations:</p>
<ul>
<li><strong>Almost similar rates across age groups :</strong>
<ul>
<li>Heart attack rates range between 8.9% and 10.3%, showing no extreme variation.</li>
<li>Young Adults (26–40) &amp; Elderly (≥71) have the highest rate - at 10.3%</li>
<li>Youth (≤25) has the lowest rate - at 8.9%, only slightly lower than other groups.</li>
</ul></li>
<li><strong>Suggests that age alone may not be the strongest predictor of heart attack risk, and other lifestyle or health factors might play a key role.</strong></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Code()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Graph()</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Age Category Labels with Age Ranges</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>age_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Youth (≤25 years)"</span>, </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Young adults (26–40 years)"</span>, </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Middle-aged adults (41–55 years)"</span>, </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Older adults (56–70 years)"</span>, </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Elderly (≥71 years)"</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Count total individuals per age category</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>total_population <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Category) <span class="sc">%&gt;%</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total_Count =</span> <span class="fu">n</span>())</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Count heart attack occurrences per age category</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>heart_attack_counts <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Category) <span class="sc">%&gt;%</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Heart_Attack_Count =</span> <span class="fu">n</span>())</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge both datasets and calculate the normalized heart attack rate</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>normalized_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(heart_attack_counts, total_population, <span class="at">by =</span> <span class="st">"Age_Category"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Normalized_Heart_Attack_Rate =</span> (Heart_Attack_Count <span class="sc">/</span> Total_Count) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert Age_Category into a factor with labels</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Category =</span> <span class="fu">factor</span>(Age_Category, </span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Youth"</span>, <span class="st">"Young Adult"</span>, <span class="st">"Middle-Aged Adult"</span>, <span class="st">"Older Adult"</span>, <span class="st">"Elderly"</span>), </span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>                               <span class="at">labels =</span> age_labels))</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create bar plot with normalized rates</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normalized_data, <span class="fu">aes</span>(<span class="at">x =</span> Age_Category, <span class="at">y =</span> Normalized_Heart_Attack_Rate, <span class="at">fill =</span> Age_Category)) <span class="sc">+</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add data labels to show percentages</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Normalized_Heart_Attack_Rate)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>,<span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normalized Heart Attack Rate by Age Group"</span>,</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Group"</span>,</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Heart Attack Rate (% of total in group)"</span>,</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Age Categories (with Ranges)"</span>) <span class="sc">+</span>  <span class="co"># Updated legend title</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="age-distribution-differs-between-heart-attack-occurences---ridgeline-density-plot" class="level5">
<h5 class="anchored" data-anchor-id="age-distribution-differs-between-heart-attack-occurences---ridgeline-density-plot">3.6.2.3 Age distribution differs between heart attack occurences - ridgeline density plot</h5>
<p>Observations:</p>
<ul>
<li>The Heart Attack Occurence = “No” group is more evenly distributed across age ranges</li>
<li>Heart attacks are more common in Young adults and older individuals (higher density for “Yes” group in older ages).</li>
<li>Youth rarely experience heart attacks, though some cases exist.</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Code()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Graph()</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure Heart Attack Occurrence is a factor</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>heart_attack_2 <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Heart_Attack_Occurrence =</span> <span class="fu">factor</span>(Heart_Attack_Occurrence, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Ridgeline Density Plot </span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heart_attack_2, <span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Heart_Attack_Occurrence, <span class="at">fill =</span> <span class="fu">after_stat</span>(x))) <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges_gradient</span>(<span class="at">scale =</span> <span class="dv">2</span>, <span class="at">rel_min_height =</span> <span class="fl">0.01</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"magma"</span>) <span class="sc">+</span>  </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ridgeline Density Plot: Age Distribution by Heart Attack Occurrence"</span>,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age"</span>,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Heart Attack Occurrence"</span>,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Age"</span>) <span class="sc">+</span>  </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="heart-attack-occurrence-across-age-categories-funnel-plot-analysis" class="level5">
<h5 class="anchored" data-anchor-id="heart-attack-occurrence-across-age-categories-funnel-plot-analysis">3.6.2.2 Heart Attack Occurrence Across Age Categories – Funnel Plot Analysis</h5>
<p>The analysis is based on five age categories, with heart attack occurrence represented as a proportion.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Categories</th>
<th>Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Youth</td>
<td>≤25 years</td>
</tr>
<tr class="even">
<td>Young adults</td>
<td>26–40 years</td>
</tr>
<tr class="odd">
<td>Middle-aged adults</td>
<td>41–55 years</td>
</tr>
<tr class="even">
<td>Older adults</td>
<td>56–70 years</td>
</tr>
<tr class="odd">
<td>Elderly</td>
<td>≥71 years</td>
</tr>
</tbody>
</table>
<p>Observations:</p>
<ul>
<li>No overdispersion was detected, meaning the data does not exhibit excessive variance beyond what is expected.</li>
<li>The funnel plot confirms that all data points fall within expected control limits, indicating no statistically significant outliers.</li>
<li>Although, the heart attack occurrence rate varies among age categories but remains within the expected range.</li>
</ul>
<p><strong>Further analysis might be needed</strong> to examine specific risk factors that contribute to heart attack rates in different age groups.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Code()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Graph()</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Convert "Yes"/"No" to 1/0</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>heart_attack_2 <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Heart_Attack_Occurrence =</span> <span class="fu">ifelse</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Summarize data for all 5 age categories</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>age_summary <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Category) <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Heart_Attack_Count =</span> <span class="fu">sum</span>(Heart_Attack_Occurrence, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Numerator</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Population =</span> <span class="fu">n</span>()  <span class="co"># Denominator</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Funnel Plot for all age categories</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="fu">funnel_plot</span>(</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">.data =</span> age_summary,</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">numerator =</span> <span class="st">"Heart_Attack_Count"</span>,</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">denominator =</span> <span class="st">"Total_Population"</span>,</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"Age_Category"</span>,</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_type =</span> <span class="st">"PR"</span>,  <span class="co"># Proportion Rate</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(age_summary<span class="sc">$</span>Total_Population) <span class="sc">+</span> <span class="dv">500</span>),  <span class="co"># Adjusted for better scaling</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(age_summary<span class="sc">$</span>Heart_Attack_Count <span class="sc">/</span> age_summary<span class="sc">$</span>Total_Population) <span class="sc">+</span> <span class="fl">0.02</span>)  <span class="co"># Ensure proportions are visible</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>A funnel plot object with 5 points of which 0 are outliers. 
Plot is not adjusted for overdispersion. </code></pre>
</div>
</div>
</div>
</div>
</div>
<!-- ```{r} -->
<!-- # Step 1: Count total individuals in each Age_Category -->
<!-- total_population <- heart_attack_2 %>% -->
<!--   group_by(Age_Category) %>% -->
<!--   summarise(Total_Count = n()) -->
<!-- # Step 2: Count heart attack occurrences by Age_Category -->
<!-- heart_attack_counts <- heart_attack_2 %>% -->
<!--   filter(Heart_Attack_Occurrence == "Yes") %>% -->
<!--   group_by(Age_Category) %>% -->
<!--   summarise(Heart_Attack_Count = n()) -->
<!-- # Step 3: Merge the two tables -->
<!-- normalized_data <- left_join(heart_attack_counts, total_population, by = "Age_Category") %>% -->
<!--   mutate(Normalized_Heart_Attack_Rate = (Heart_Attack_Count / Total_Count) * 100) -->
<!-- # Step 4: Plot the normalized heart attack rate -->
<!-- ggplot(normalized_data, aes(x = Age_Category, y = Normalized_Heart_Attack_Rate, fill = Age_Category)) + -->
<!--   geom_bar(stat = "identity", color = "black", alpha = 0.7) + -->
<!--   labs(title = "Normalized Heart Attack Rate by Age Group", -->
<!--        x = "Age Group", -->
<!--        y = "Heart Attack Rate (Normalized, % of total in group)") + -->
<!--   theme_minimal() + -->
<!--   scale_fill_brewer(palette = "Set2") + -->
<!--   theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for readability -->
<!-- ``` -->
<ul>
<li>Ch</li>
</ul>


<!-- -->

</section>
</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb45" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Take-home Exercise 01"</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Andrea Yeo"</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> "last-modified"</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "February 1, 2025"</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co">  eval: true</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co">  freeze: true</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="fu"># Heart Attack in Japan Youth Vs Adult</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. Overview</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1.1 Background</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>This analysis explores heart attack incidents in Japan, focusing on the differences in risk factors between youth and adult age groups. With the growing global prevalence of heart disease, understanding <span class="co">[</span><span class="ot">*how age influences heart attack likelihood*</span><span class="co">]</span>{.underline} and <span class="co">[</span><span class="ot">*identifying the strongest predictors*</span><span class="co">]</span>{.underline} are crucial for shaping targeted prevention strategies and healthcare interventions.</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>The dataset from Kaggle - <span class="co">[</span><span class="ot">Heart Attack in Japan Youth Vs Adult</span><span class="co">](https://www.kaggle.com/datasets/ashaychoudhary/heart-attack-in-japan-youth-vs-adult)</span> provides an opportunity to analyze these aspects, helping healthcare providers, policymakers, and researchers develop age-specific awareness campaigns, preventive measures, and resource allocation strategies tailored to reducing heart attack risks in Japan.</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1.2 Research objective</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>Using the <span class="co">[</span><span class="ot">Heart Attack in Japan: Youth vs. Adult</span><span class="co">](https://www.kaggle.com/datasets/ashaychoudhary/heart-attack-in-japan-youth-vs-adult)</span> dataset, this Take-home_Ex01 applies appropriate Exploratory Data Analysis (EDA) methods, using the <span class="co">[</span><span class="ot">tidyverse</span><span class="co">](https://www.tidyverse.org/)</span> package and <span class="co">[</span><span class="ot">ggplot</span><span class="co">](https://www.rdocumentation.org/packages/ggplot2/versions/0.9.0/topics/ggplot)</span> functions to:</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**explore how age influences the likelihood of heart attack incidents**</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**identify the strongest predictors contributing to heart attack incidents**</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. Getting started</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.1 Loading the packages</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>The following R packages will be loaded for this exercise using <span class="in">`pacman::p_load()`</span>:</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**readr**</span><span class="co">](https://www.rdocumentation.org/packages/readr/versions/2.1.5)</span>: Part of a tidyverse package for fast and efficient reading of rectangular data (CSV, TSV, and other delimited files) into R</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**dplyr**</span><span class="co">](https://www.rdocumentation.org/packages/dplyr/versions/0.5.0)</span>: Part of a tidyverse package for efficient data manipulation, including filtering, selecting, mutating, summarizing, and grouping data in R</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**ggplot2**</span><span class="co">](https://www.rdocumentation.org/packages/ggplot2/versions/3.5.0)</span>: Part of a tidyverse package allowing for flexible and layered creation of complex plots</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**tidyverse**</span><span class="co">](https://www.rdocumentation.org/packages/tidyverse/versions/2.0.0)</span>: A collection of R packages for data manipulation, visualization, and analysis</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**knitr**</span><span class="co">](https://www.rdocumentation.org/packages/knitr/versions/1.48)</span>: Enables dynamic report generation with R Markdown</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**patchwork**</span><span class="co">](https://www.rdocumentation.org/packages/patchwork/versions/0.0.1)</span>: Combines multiple ggplot2 plots into a single layout</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**ggthemes**</span><span class="co">](https://www.rdocumentation.org/packages/ggthemes/versions/5.1.0)</span>: Provides additional themes and scales for ggplot2</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**scales**</span><span class="co">](https://www.rdocumentation.org/packages/scales/versions/0.4.1)</span>: Enhances visualization by formatting axes and legends in ggplot2</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**ggridges**</span><span class="co">](https://www.rdocumentation.org/packages/ggridges/versions/0.5.6)</span>: Creates ridge plots for density visualization</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**ggpubr**</span><span class="co">](https://www.rdocumentation.org/packages/ggpubr/versions/0.6.0)</span>: Simplifies publication-ready ggplot2 visualizations</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**gganimate**</span><span class="co">](https://www.rdocumentation.org/packages/gganimate/versions/1.0.9)</span>: Adds animation capabilities to ggplot2 graphics</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**ggdist**</span><span class="co">](https://www.rdocumentation.org/packages/ggdist/versions/3.3.2)</span>: Visualizes uncertainty and statistical distributions in ggplot2</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**ggtext**</span><span class="co">](https://www.rdocumentation.org/packages/ggtext/versions/0.1.2)</span>: Enhances text rendering and formatting in ggplot2</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**ggalt**</span><span class="co">](https://www.rdocumentation.org/packages/GGally/versions/2.2.1)</span>: Provides additional geoms, including dumbbell plots and lollipop charts</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**cowplot**</span><span class="co">](https://www.rdocumentation.org/packages/cowplot/versions/1.1.3)</span>: Enhances ggplot2-based layouts and plot annotations</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**ggnewscale**</span><span class="co">](https://www.rdocumentation.org/packages/ggnewscale/versions/0.4.5)</span>: Allows multiple color and fill scales in a single ggplot2 plot</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**ggrepel**</span><span class="co">](https://www.rdocumentation.org/packages/ggrepel/versions/0.9.6)</span>: Prevents overlapping text labels in ggplot2 plots</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**FunnelPlotrR**</span><span class="co">](https://www.rdocumentation.org/packages/rmeta/versions/3.0/topics/funnelplot)</span>:Used to create funnel plots for visualizing and comparing proportions, rates, or ratios across different groups while accounting for statistical variation.</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, haven, knitr,</span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a>               patchwork, ggthemes, scales,</span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a>               ggridges, ggpubr, gganimate,</span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a>               ggdist, ggtext, ggalt,</span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a>               cowplot, ggnewscale,FunnelPlotR)</span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. Data wrangling &amp; data prepration</span></span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.1 Importing the data</span></span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a>The code chunk below imports the <span class="co">[</span><span class="ot">Heart Attack in Japan: Youth vs. Adult</span><span class="co">](https://www.kaggle.com/datasets/ashaychoudhary/heart-attack-in-japan-youth-vs-adult)</span> dataset, downloaded from Kaggle, using the read_csv() function from the readr package.</span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a>heart_attack <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/japan_heart_attack_dataset.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a>heart_attack</span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a>The dataset is structured as a tibble dataframe, containing 30,000 rows and 32 columns. Each observation represents an individual case, and the variables capture key medical and demographic information relevant to heart attack incidents across different age groups in Japan.</span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.4 Checking the data structure</span></span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a>We will check the dataset using below</span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`glimpse()`</span>: provides a transposed overview of a dataset, showing variables and their types in a concise format.</span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`head()`</span>: displays the first few rows of a dataset (default is 6 rows) to give a quick preview of the data.</span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`summary()`</span>: generates a statistical summary of each variable, including measures like mean, median, and range for numeric data.</span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`duplicated()`</span>:returns a logical vector indicating which elements or rows in a vector or data frame are duplicates.</span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`colSums(is.na())`</span>: counts the number of missing values (NA) in each column of the data frame.</span>
<span id="cb45-90"><a href="#cb45-90" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`spec()`</span>: use <span class="in">`spec()`</span> to quickly inspect the column</span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-92"><a href="#cb45-92" aria-hidden="true" tabindex="-1"></a>:::::: panel-tabset</span>
<span id="cb45-93"><a href="#cb45-93" aria-hidden="true" tabindex="-1"></a><span class="fu">## glimpse()</span></span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-97"><a href="#cb45-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-98"><a href="#cb45-98" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(heart_attack)</span>
<span id="cb45-99"><a href="#cb45-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-100"><a href="#cb45-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-101"><a href="#cb45-101" aria-hidden="true" tabindex="-1"></a><span class="fu">## head()</span></span>
<span id="cb45-102"><a href="#cb45-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-105"><a href="#cb45-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-106"><a href="#cb45-106" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(heart_attack)</span>
<span id="cb45-107"><a href="#cb45-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-108"><a href="#cb45-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-109"><a href="#cb45-109" aria-hidden="true" tabindex="-1"></a><span class="fu">## summary()</span></span>
<span id="cb45-110"><a href="#cb45-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-113"><a href="#cb45-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-114"><a href="#cb45-114" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(heart_attack)</span>
<span id="cb45-115"><a href="#cb45-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-116"><a href="#cb45-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-117"><a href="#cb45-117" aria-hidden="true" tabindex="-1"></a><span class="fu">## duplicated()</span></span>
<span id="cb45-118"><a href="#cb45-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-121"><a href="#cb45-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-122"><a href="#cb45-122" aria-hidden="true" tabindex="-1"></a>heart_attack[<span class="fu">duplicated</span>(heart_attack),]</span>
<span id="cb45-123"><a href="#cb45-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-124"><a href="#cb45-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-125"><a href="#cb45-125" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb45-126"><a href="#cb45-126" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ensure that there are no duplicated columns, if not will have to investigate further.</span>
<span id="cb45-127"><a href="#cb45-127" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-128"><a href="#cb45-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-129"><a href="#cb45-129" aria-hidden="true" tabindex="-1"></a><span class="fu">## colSum(is.na())</span></span>
<span id="cb45-130"><a href="#cb45-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-133"><a href="#cb45-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-134"><a href="#cb45-134" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(heart_attack))</span>
<span id="cb45-135"><a href="#cb45-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-136"><a href="#cb45-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-137"><a href="#cb45-137" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb45-138"><a href="#cb45-138" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ensure that there are no NA values, if not will have to investigate further.</span>
<span id="cb45-139"><a href="#cb45-139" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Possibility to use <span class="in">`drop_na()`</span> function to drop rows where any specified column contains a missing value.</span>
<span id="cb45-140"><a href="#cb45-140" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-141"><a href="#cb45-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-142"><a href="#cb45-142" aria-hidden="true" tabindex="-1"></a><span class="fu">## spec())</span></span>
<span id="cb45-143"><a href="#cb45-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-146"><a href="#cb45-146" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-147"><a href="#cb45-147" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span>(heart_attack)</span>
<span id="cb45-148"><a href="#cb45-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-149"><a href="#cb45-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-150"><a href="#cb45-150" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb45-151"><a href="#cb45-151" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ensure that all variables are correctly classified by data type; recast variable types if needed.</span>
<span id="cb45-152"><a href="#cb45-152" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Variables are correctly classified - where categorical variables are classified as **character**, while continuous variables are classified as **double**.</span>
<span id="cb45-153"><a href="#cb45-153" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-154"><a href="#cb45-154" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb45-155"><a href="#cb45-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-156"><a href="#cb45-156" aria-hidden="true" tabindex="-1"></a>The heart_attack tibble contains 32 attributes, as shown above.</span>
<span id="cb45-157"><a href="#cb45-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-158"><a href="#cb45-158" aria-hidden="true" tabindex="-1"></a>The following preprocessing checks were conducted as part of data preparation:</span>
<span id="cb45-159"><a href="#cb45-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-160"><a href="#cb45-160" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb45-161"><a href="#cb45-161" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preprocessing Checks</span></span>
<span id="cb45-162"><a href="#cb45-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-163"><a href="#cb45-163" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Verified that the correct data types were loaded in the <span class="in">`heart_attack`</span> dataset using <span class="in">`glimpse()`</span> and <span class="in">`spec()`</span></span>
<span id="cb45-164"><a href="#cb45-164" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ensured there were no duplicate variable names using <span class="in">`duplicated()`</span> in the dataset</span>
<span id="cb45-165"><a href="#cb45-165" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Checked for missing values using <span class="in">`colSums(is.na())`</span></span>
<span id="cb45-166"><a href="#cb45-166" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-167"><a href="#cb45-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-168"><a href="#cb45-168" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.2 Understanding the metadata</span></span>
<span id="cb45-169"><a href="#cb45-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-170"><a href="#cb45-170" aria-hidden="true" tabindex="-1"></a>The table below presents the metadata for the dataset, classifying each variable as either categorical or continuous based on its nature and data type.</span>
<span id="cb45-171"><a href="#cb45-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-172"><a href="#cb45-172" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Categorical attributes:**</span>
<span id="cb45-173"><a href="#cb45-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-174"><a href="#cb45-174" aria-hidden="true" tabindex="-1"></a>    +-------------------------+-------------+------------------------------------------------------------------------------+</span>
<span id="cb45-175"><a href="#cb45-175" aria-hidden="true" tabindex="-1"></a>    | Variable Names          | Type        | Description                                                                  |</span>
<span id="cb45-176"><a href="#cb45-176" aria-hidden="true" tabindex="-1"></a>    +=========================+=============+==============================================================================+</span>
<span id="cb45-177"><a href="#cb45-177" aria-hidden="true" tabindex="-1"></a>    | Gender                  | CHAR        | Biological sex of the individual (e.g., Male, Female)                        |</span>
<span id="cb45-178"><a href="#cb45-178" aria-hidden="true" tabindex="-1"></a>    +-------------------------+-------------+------------------------------------------------------------------------------+</span>
<span id="cb45-179"><a href="#cb45-179" aria-hidden="true" tabindex="-1"></a>    | Region                  | CHAR        | Geographic location where the individual resides (e.g., Urban, Rural)        |</span>
<span id="cb45-180"><a href="#cb45-180" aria-hidden="true" tabindex="-1"></a>    +-------------------------+-------------+------------------------------------------------------------------------------+</span>
<span id="cb45-181"><a href="#cb45-181" aria-hidden="true" tabindex="-1"></a>    | Smoking_History         | CHAR        | Past or current smoking habits (e.g., Yes, No)                               |</span>
<span id="cb45-182"><a href="#cb45-182" aria-hidden="true" tabindex="-1"></a>    +-------------------------+-------------+------------------------------------------------------------------------------+</span>
<span id="cb45-183"><a href="#cb45-183" aria-hidden="true" tabindex="-1"></a>    | Diabetes_History        | CHAR        | History of diabetes diagnosis (Yes/No)                                       |</span>
<span id="cb45-184"><a href="#cb45-184" aria-hidden="true" tabindex="-1"></a>    +-------------------------+-------------+------------------------------------------------------------------------------+</span>
<span id="cb45-185"><a href="#cb45-185" aria-hidden="true" tabindex="-1"></a>    | Hypertension_History    | CHAR        | History of high blood pressure diagnosis (Yes/No)                            |</span>
<span id="cb45-186"><a href="#cb45-186" aria-hidden="true" tabindex="-1"></a>    +-------------------------+-------------+------------------------------------------------------------------------------+</span>
<span id="cb45-187"><a href="#cb45-187" aria-hidden="true" tabindex="-1"></a>    | Physical_Activity       | CHAR        | Level of physical activity (e.g., Low, Moderate, High)                       |</span>
<span id="cb45-188"><a href="#cb45-188" aria-hidden="true" tabindex="-1"></a>    +-------------------------+-------------+------------------------------------------------------------------------------+</span>
<span id="cb45-189"><a href="#cb45-189" aria-hidden="true" tabindex="-1"></a>    | Diet_Quality            | CHAR        | Dietary habits and nutritional intake assessment (e.g., Poor, Average, Good) |</span>
<span id="cb45-190"><a href="#cb45-190" aria-hidden="true" tabindex="-1"></a>    +-------------------------+-------------+------------------------------------------------------------------------------+</span>
<span id="cb45-191"><a href="#cb45-191" aria-hidden="true" tabindex="-1"></a>    | Alcohol_Consumption     | CHAR        | Frequency or amount of alcohol intake (e.g., Low, Moderate, High, None)      |</span>
<span id="cb45-192"><a href="#cb45-192" aria-hidden="true" tabindex="-1"></a>    +-------------------------+-------------+------------------------------------------------------------------------------+</span>
<span id="cb45-193"><a href="#cb45-193" aria-hidden="true" tabindex="-1"></a>    | Family_History          | CHAR        | Presence of heart disease in close relatives (Yes/No)                        |</span>
<span id="cb45-194"><a href="#cb45-194" aria-hidden="true" tabindex="-1"></a>    +-------------------------+-------------+------------------------------------------------------------------------------+</span>
<span id="cb45-195"><a href="#cb45-195" aria-hidden="true" tabindex="-1"></a>    | Heart_Attack_Occurrence | CHAR        | Whether the individual has experienced a heart attack (Yes/No)               |</span>
<span id="cb45-196"><a href="#cb45-196" aria-hidden="true" tabindex="-1"></a>    +-------------------------+-------------+------------------------------------------------------------------------------+</span>
<span id="cb45-197"><a href="#cb45-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-198"><a href="#cb45-198" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Continuous attributes:**</span>
<span id="cb45-199"><a href="#cb45-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-200"><a href="#cb45-200" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-201"><a href="#cb45-201" aria-hidden="true" tabindex="-1"></a>    | Variable Names    | Type         | Description                                        |</span>
<span id="cb45-202"><a href="#cb45-202" aria-hidden="true" tabindex="-1"></a>    +===================+==============+====================================================+</span>
<span id="cb45-203"><a href="#cb45-203" aria-hidden="true" tabindex="-1"></a>    | Age               | NUM          | Age of the individual in years                     |</span>
<span id="cb45-204"><a href="#cb45-204" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-205"><a href="#cb45-205" aria-hidden="true" tabindex="-1"></a>    | Cholesterol_Level | NUM          | Measured cholesterol level in the blood            |</span>
<span id="cb45-206"><a href="#cb45-206" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-207"><a href="#cb45-207" aria-hidden="true" tabindex="-1"></a>    | Stress_Levels     | NUM          | Measured or self-reported stress level             |</span>
<span id="cb45-208"><a href="#cb45-208" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-209"><a href="#cb45-209" aria-hidden="true" tabindex="-1"></a>    | BMI               | NUM          | Body Mass Index, calculated from height and weight |</span>
<span id="cb45-210"><a href="#cb45-210" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-211"><a href="#cb45-211" aria-hidden="true" tabindex="-1"></a>    | Heart_Rate        | NUM          | Resting heart rate in beats per minute (bpm)       |</span>
<span id="cb45-212"><a href="#cb45-212" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-213"><a href="#cb45-213" aria-hidden="true" tabindex="-1"></a>    | Systolic_BP       | NUM          | Systolic blood pressure measurement (mmHg)         |</span>
<span id="cb45-214"><a href="#cb45-214" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-215"><a href="#cb45-215" aria-hidden="true" tabindex="-1"></a>    | Diastolic_BP      | NUM          | Diastolic blood pressure measurement (mmHg)        |</span>
<span id="cb45-216"><a href="#cb45-216" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-217"><a href="#cb45-217" aria-hidden="true" tabindex="-1"></a>    | Extra_Column_1    | NUM          |                                                    |</span>
<span id="cb45-218"><a href="#cb45-218" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-219"><a href="#cb45-219" aria-hidden="true" tabindex="-1"></a>    | Extra_Column_2    | NUM          |                                                    |</span>
<span id="cb45-220"><a href="#cb45-220" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-221"><a href="#cb45-221" aria-hidden="true" tabindex="-1"></a>    | Extra_Column_3    | NUM          |                                                    |</span>
<span id="cb45-222"><a href="#cb45-222" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-223"><a href="#cb45-223" aria-hidden="true" tabindex="-1"></a>    | Extra_Column_4    | NUM          |                                                    |</span>
<span id="cb45-224"><a href="#cb45-224" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-225"><a href="#cb45-225" aria-hidden="true" tabindex="-1"></a>    | Extra_Column_5    | NUM          |                                                    |</span>
<span id="cb45-226"><a href="#cb45-226" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-227"><a href="#cb45-227" aria-hidden="true" tabindex="-1"></a>    | Extra_Column_6    | NUM          |                                                    |</span>
<span id="cb45-228"><a href="#cb45-228" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-229"><a href="#cb45-229" aria-hidden="true" tabindex="-1"></a>    | Extra_Column_7    | NUM          |                                                    |</span>
<span id="cb45-230"><a href="#cb45-230" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-231"><a href="#cb45-231" aria-hidden="true" tabindex="-1"></a>    | Extra_Column_8    | NUM          |                                                    |</span>
<span id="cb45-232"><a href="#cb45-232" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-233"><a href="#cb45-233" aria-hidden="true" tabindex="-1"></a>    | Extra_Column_9    | NUM          |                                                    |</span>
<span id="cb45-234"><a href="#cb45-234" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-235"><a href="#cb45-235" aria-hidden="true" tabindex="-1"></a>    | Extra_Column_10   | NUM          |                                                    |</span>
<span id="cb45-236"><a href="#cb45-236" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-237"><a href="#cb45-237" aria-hidden="true" tabindex="-1"></a>    | Extra_Column_11   | NUM          |                                                    |</span>
<span id="cb45-238"><a href="#cb45-238" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-239"><a href="#cb45-239" aria-hidden="true" tabindex="-1"></a>    | Extra_Column_12   | NUM          |                                                    |</span>
<span id="cb45-240"><a href="#cb45-240" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-241"><a href="#cb45-241" aria-hidden="true" tabindex="-1"></a>    | Extra_Column_13   | NUM          |                                                    |</span>
<span id="cb45-242"><a href="#cb45-242" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-243"><a href="#cb45-243" aria-hidden="true" tabindex="-1"></a>    | Extra_Column_14   | NUM          |                                                    |</span>
<span id="cb45-244"><a href="#cb45-244" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-245"><a href="#cb45-245" aria-hidden="true" tabindex="-1"></a>    | Extra_Column_15   | NUM          |                                                    |</span>
<span id="cb45-246"><a href="#cb45-246" aria-hidden="true" tabindex="-1"></a>    +-------------------+--------------+----------------------------------------------------+</span>
<span id="cb45-247"><a href="#cb45-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-248"><a href="#cb45-248" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb45-249"><a href="#cb45-249" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Notice that Extra_Column_1 to Extra_Column_15 are additional numeric figures without clear definition.</span>
<span id="cb45-250"><a href="#cb45-250" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>They are most likely derived calculations from the variables.</span>
<span id="cb45-251"><a href="#cb45-251" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-252"><a href="#cb45-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-253"><a href="#cb45-253" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.3 Filtering for relevant variables</span></span>
<span id="cb45-254"><a href="#cb45-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-255"><a href="#cb45-255" aria-hidden="true" tabindex="-1"></a>Of the 32 variables (columns), only 17 variables(columns) are selected for analysis</span>
<span id="cb45-256"><a href="#cb45-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-257"><a href="#cb45-257" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>All columns are selected except for Extra_Column_1 to Extra_Column_15</span>
<span id="cb45-258"><a href="#cb45-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-259"><a href="#cb45-259" aria-hidden="true" tabindex="-1"></a>The <span class="in">`select()`</span> function in the <span class="co">[</span><span class="ot">dplyr</span><span class="co">](https://www.rdocumentation.org/packages/dplyr/versions/0.5.0)</span> package is used to obtain these rows, and stored as the R object, <span class="in">`heart_attack_1`</span>.</span>
<span id="cb45-260"><a href="#cb45-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-263"><a href="#cb45-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-264"><a href="#cb45-264" aria-hidden="true" tabindex="-1"></a>heart_attack_1 <span class="ot">&lt;-</span> heart_attack <span class="sc">%&gt;%</span> </span>
<span id="cb45-265"><a href="#cb45-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"Age"</span>, <span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Smoking_History"</span>, <span class="st">"Diabetes_History"</span>, </span>
<span id="cb45-266"><a href="#cb45-266" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Hypertension_History"</span>, <span class="st">"Cholesterol_Level"</span>, <span class="st">"Physical_Activity"</span>, </span>
<span id="cb45-267"><a href="#cb45-267" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Diet_Quality"</span>, <span class="st">"Alcohol_Consumption"</span>, <span class="st">"Stress_Levels"</span>, <span class="st">"BMI"</span>, </span>
<span id="cb45-268"><a href="#cb45-268" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Heart_Rate"</span>, <span class="st">"Systolic_BP"</span>, <span class="st">"Diastolic_BP"</span>, <span class="st">"Family_History"</span>, </span>
<span id="cb45-269"><a href="#cb45-269" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Heart_Attack_Occurrence"</span>)</span>
<span id="cb45-270"><a href="#cb45-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-271"><a href="#cb45-271" aria-hidden="true" tabindex="-1"></a>heart_attack_1</span>
<span id="cb45-272"><a href="#cb45-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-273"><a href="#cb45-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-274"><a href="#cb45-274" aria-hidden="true" tabindex="-1"></a>The output shows a tibble dataframe with 30,000 rows and 17 columns.</span>
<span id="cb45-275"><a href="#cb45-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-276"><a href="#cb45-276" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.5 Recoding and creating of new variables</span></span>
<span id="cb45-277"><a href="#cb45-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-278"><a href="#cb45-278" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3.5.1 Recoding continuous variables into categorical variables</span></span>
<span id="cb45-279"><a href="#cb45-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-280"><a href="#cb45-280" aria-hidden="true" tabindex="-1"></a>In the following section, we will recode specific continuous variables into categorical groups for better interpretability. While variables like *Cholesterol_Level*, *Stress_Levels*, *BMI*, *Heart_Rate*, *Systolic_BP*, and *Diastolic_BP* provide valuable insights in their continuous form, categorizing them into meaningful groups will enhance our ability to analyze trends and risk factors more effectively.</span>
<span id="cb45-281"><a href="#cb45-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-282"><a href="#cb45-282" aria-hidden="true" tabindex="-1"></a>+-------------------+---------------------+---------------------------------------------------------------------------------------------------+</span>
<span id="cb45-283"><a href="#cb45-283" aria-hidden="true" tabindex="-1"></a>| Variable Names    | Measurement         | Categorical ranges <span class="co">[</span><span class="ot">*Approximated classification based on best effort*</span><span class="co">]</span>{style="font-size: 10px;"} |</span>
<span id="cb45-284"><a href="#cb45-284" aria-hidden="true" tabindex="-1"></a>+===================+=====================+===================================================================================================+</span>
<span id="cb45-285"><a href="#cb45-285" aria-hidden="true" tabindex="-1"></a>| Cholesterol_Level | mg/dL               | -   **Low:** ≤ 150                                                                                |</span>
<span id="cb45-286"><a href="#cb45-286" aria-hidden="true" tabindex="-1"></a>|                   |                     | -   **Moderate:** 151–200                                                                         |</span>
<span id="cb45-287"><a href="#cb45-287" aria-hidden="true" tabindex="-1"></a>|                   |                     | -   **High:** <span class="sc">\&gt;</span> 200                                                                              |</span>
<span id="cb45-288"><a href="#cb45-288" aria-hidden="true" tabindex="-1"></a>+-------------------+---------------------+---------------------------------------------------------------------------------------------------+</span>
<span id="cb45-289"><a href="#cb45-289" aria-hidden="true" tabindex="-1"></a>| Stress_Levels     | Self-reported scale | -   **Miniminal Stress:** 0 \|                                                                    |</span>
<span id="cb45-290"><a href="#cb45-290" aria-hidden="true" tabindex="-1"></a>|                   |                     | -   **Low Stress:** 1–3                                                                           |</span>
<span id="cb45-291"><a href="#cb45-291" aria-hidden="true" tabindex="-1"></a>|                   |                     | -   **Moderate Stress:** 4–7                                                                      |</span>
<span id="cb45-292"><a href="#cb45-292" aria-hidden="true" tabindex="-1"></a>|                   |                     | -   **High Stress:** 8–10                                                                         |</span>
<span id="cb45-293"><a href="#cb45-293" aria-hidden="true" tabindex="-1"></a>+-------------------+---------------------+---------------------------------------------------------------------------------------------------+</span>
<span id="cb45-294"><a href="#cb45-294" aria-hidden="true" tabindex="-1"></a>| BMI               | Body Mass Index     | -   **Underweight:** <span class="sc">\&lt;</span> 18.5                                                                      |</span>
<span id="cb45-295"><a href="#cb45-295" aria-hidden="true" tabindex="-1"></a>|                   |                     | -   **Normal Weight:** 18.5–24.9                                                                  |</span>
<span id="cb45-296"><a href="#cb45-296" aria-hidden="true" tabindex="-1"></a>|                   |                     | -   **Overweight:** 25–29.9                                                                       |</span>
<span id="cb45-297"><a href="#cb45-297" aria-hidden="true" tabindex="-1"></a>|                   |                     | -   **Obese:** ≥ 30                                                                               |</span>
<span id="cb45-298"><a href="#cb45-298" aria-hidden="true" tabindex="-1"></a>+-------------------+---------------------+---------------------------------------------------------------------------------------------------+</span>
<span id="cb45-299"><a href="#cb45-299" aria-hidden="true" tabindex="-1"></a>| Heart_Rate        | beats per minute    | -   **Bradycardia (Low):** <span class="sc">\&lt;</span> 60                                                                  |</span>
<span id="cb45-300"><a href="#cb45-300" aria-hidden="true" tabindex="-1"></a>|                   |                     | -   **Normal:** 60–100                                                                            |</span>
<span id="cb45-301"><a href="#cb45-301" aria-hidden="true" tabindex="-1"></a>|                   |                     | -   **Tachycardia (High):** <span class="sc">\&gt;</span> 100                                                                |</span>
<span id="cb45-302"><a href="#cb45-302" aria-hidden="true" tabindex="-1"></a>+-------------------+---------------------+---------------------------------------------------------------------------------------------------+</span>
<span id="cb45-303"><a href="#cb45-303" aria-hidden="true" tabindex="-1"></a>| Systolic_BP       | mmHg                | -   **Normal:** <span class="sc">\&lt;</span> 120                                                                            |</span>
<span id="cb45-304"><a href="#cb45-304" aria-hidden="true" tabindex="-1"></a>|                   |                     | -   **Elevated:** 120–129                                                                         |</span>
<span id="cb45-305"><a href="#cb45-305" aria-hidden="true" tabindex="-1"></a>|                   |                     | -   **Hypertension Stage 1:** 130–139                                                             |</span>
<span id="cb45-306"><a href="#cb45-306" aria-hidden="true" tabindex="-1"></a>|                   |                     | -   **Hypertension Stage 2:** ≥ 140                                                               |</span>
<span id="cb45-307"><a href="#cb45-307" aria-hidden="true" tabindex="-1"></a>+-------------------+---------------------+---------------------------------------------------------------------------------------------------+</span>
<span id="cb45-308"><a href="#cb45-308" aria-hidden="true" tabindex="-1"></a>| Diastolic_BP      | mmHg                | -   **Normal:** <span class="sc">\&lt;</span> 80                                                                             |</span>
<span id="cb45-309"><a href="#cb45-309" aria-hidden="true" tabindex="-1"></a>|                   |                     | -   **Elevated:** 80–89                                                                           |</span>
<span id="cb45-310"><a href="#cb45-310" aria-hidden="true" tabindex="-1"></a>|                   |                     | -   **Hypertension Stage 1:** 90–99                                                               |</span>
<span id="cb45-311"><a href="#cb45-311" aria-hidden="true" tabindex="-1"></a>|                   |                     | -   **Hypertension Stage 2:** ≥ 100                                                               |</span>
<span id="cb45-312"><a href="#cb45-312" aria-hidden="true" tabindex="-1"></a>+-------------------+---------------------+---------------------------------------------------------------------------------------------------+</span>
<span id="cb45-313"><a href="#cb45-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-316"><a href="#cb45-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-317"><a href="#cb45-317" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb45-318"><a href="#cb45-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-319"><a href="#cb45-319" aria-hidden="true" tabindex="-1"></a>heart_attack_1 <span class="ot">&lt;-</span> heart_attack <span class="sc">%&gt;%</span></span>
<span id="cb45-320"><a href="#cb45-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"Age"</span>, <span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Smoking_History"</span>, <span class="st">"Diabetes_History"</span>, </span>
<span id="cb45-321"><a href="#cb45-321" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Hypertension_History"</span>, <span class="st">"Cholesterol_Level"</span>, <span class="st">"Physical_Activity"</span>, </span>
<span id="cb45-322"><a href="#cb45-322" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Diet_Quality"</span>, <span class="st">"Alcohol_Consumption"</span>, <span class="st">"Stress_Levels"</span>, <span class="st">"BMI"</span>, </span>
<span id="cb45-323"><a href="#cb45-323" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Heart_Rate"</span>, <span class="st">"Systolic_BP"</span>, <span class="st">"Diastolic_BP"</span>, <span class="st">"Family_History"</span>, </span>
<span id="cb45-324"><a href="#cb45-324" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Heart_Attack_Occurrence"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-325"><a href="#cb45-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-326"><a href="#cb45-326" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cholesterol_Level_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb45-327"><a href="#cb45-327" aria-hidden="true" tabindex="-1"></a>      Cholesterol_Level <span class="sc">&lt;=</span> <span class="dv">150</span> <span class="sc">~</span> <span class="st">"Low"</span>,</span>
<span id="cb45-328"><a href="#cb45-328" aria-hidden="true" tabindex="-1"></a>      Cholesterol_Level <span class="sc">&lt;=</span> <span class="dv">200</span> <span class="sc">~</span> <span class="st">"Moderate"</span>,</span>
<span id="cb45-329"><a href="#cb45-329" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"High"</span></span>
<span id="cb45-330"><a href="#cb45-330" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-331"><a href="#cb45-331" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-332"><a href="#cb45-332" aria-hidden="true" tabindex="-1"></a>    <span class="co"># **ROUND Stress_Levels before categorization**</span></span>
<span id="cb45-333"><a href="#cb45-333" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rounded_Stress_Levels =</span> <span class="fu">round</span>(Stress_Levels), </span>
<span id="cb45-334"><a href="#cb45-334" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-335"><a href="#cb45-335" aria-hidden="true" tabindex="-1"></a>    <span class="at">Stress_Levels_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb45-336"><a href="#cb45-336" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(Rounded_Stress_Levels) <span class="sc">~</span> <span class="st">"Unknown"</span>,  <span class="co"># Handle missing values</span></span>
<span id="cb45-337"><a href="#cb45-337" aria-hidden="true" tabindex="-1"></a>      Rounded_Stress_Levels <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Minimal Stress"</span>,</span>
<span id="cb45-338"><a href="#cb45-338" aria-hidden="true" tabindex="-1"></a>      Rounded_Stress_Levels <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">~</span> <span class="st">"Low Stress"</span>,</span>
<span id="cb45-339"><a href="#cb45-339" aria-hidden="true" tabindex="-1"></a>      Rounded_Stress_Levels <span class="sc">%in%</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">7</span> <span class="sc">~</span> <span class="st">"Moderate Stress"</span>,</span>
<span id="cb45-340"><a href="#cb45-340" aria-hidden="true" tabindex="-1"></a>      Rounded_Stress_Levels <span class="sc">%in%</span> <span class="dv">8</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">~</span> <span class="st">"High Stress"</span>,</span>
<span id="cb45-341"><a href="#cb45-341" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb45-342"><a href="#cb45-342" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-343"><a href="#cb45-343" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-344"><a href="#cb45-344" aria-hidden="true" tabindex="-1"></a>    <span class="at">BMI_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb45-345"><a href="#cb45-345" aria-hidden="true" tabindex="-1"></a>      BMI <span class="sc">&lt;</span> <span class="fl">18.5</span> <span class="sc">~</span> <span class="st">"Underweight"</span>,</span>
<span id="cb45-346"><a href="#cb45-346" aria-hidden="true" tabindex="-1"></a>      BMI <span class="sc">&gt;=</span> <span class="fl">18.5</span> <span class="sc">&amp;</span> BMI <span class="sc">&lt;</span> <span class="dv">25</span> <span class="sc">~</span> <span class="st">"Normal Weight"</span>,</span>
<span id="cb45-347"><a href="#cb45-347" aria-hidden="true" tabindex="-1"></a>      BMI <span class="sc">&gt;=</span> <span class="dv">25</span> <span class="sc">&amp;</span> BMI <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"Overweight"</span>,</span>
<span id="cb45-348"><a href="#cb45-348" aria-hidden="true" tabindex="-1"></a>      BMI <span class="sc">&gt;=</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"Obese"</span>,</span>
<span id="cb45-349"><a href="#cb45-349" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb45-350"><a href="#cb45-350" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-351"><a href="#cb45-351" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-352"><a href="#cb45-352" aria-hidden="true" tabindex="-1"></a>    <span class="at">Heart_Rate_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb45-353"><a href="#cb45-353" aria-hidden="true" tabindex="-1"></a>      Heart_Rate <span class="sc">&lt;</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"Bradycardia (Low)"</span>,</span>
<span id="cb45-354"><a href="#cb45-354" aria-hidden="true" tabindex="-1"></a>      Heart_Rate <span class="sc">&gt;=</span> <span class="dv">60</span> <span class="sc">&amp;</span> Heart_Rate <span class="sc">&lt;=</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb45-355"><a href="#cb45-355" aria-hidden="true" tabindex="-1"></a>      Heart_Rate <span class="sc">&gt;</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"Tachycardia (High)"</span>,</span>
<span id="cb45-356"><a href="#cb45-356" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb45-357"><a href="#cb45-357" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-358"><a href="#cb45-358" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-359"><a href="#cb45-359" aria-hidden="true" tabindex="-1"></a>    <span class="at">Systolic_BP_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb45-360"><a href="#cb45-360" aria-hidden="true" tabindex="-1"></a>      Systolic_BP <span class="sc">&lt;</span> <span class="dv">120</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb45-361"><a href="#cb45-361" aria-hidden="true" tabindex="-1"></a>      Systolic_BP <span class="sc">&gt;=</span> <span class="dv">120</span> <span class="sc">&amp;</span> Systolic_BP <span class="sc">&lt;</span> <span class="dv">130</span> <span class="sc">~</span> <span class="st">"Elevated"</span>,</span>
<span id="cb45-362"><a href="#cb45-362" aria-hidden="true" tabindex="-1"></a>      Systolic_BP <span class="sc">&gt;=</span> <span class="dv">130</span> <span class="sc">&amp;</span> Systolic_BP <span class="sc">&lt;</span> <span class="dv">140</span> <span class="sc">~</span> <span class="st">"Hypertension Stage 1"</span>,</span>
<span id="cb45-363"><a href="#cb45-363" aria-hidden="true" tabindex="-1"></a>      Systolic_BP <span class="sc">&gt;=</span> <span class="dv">140</span> <span class="sc">~</span> <span class="st">"Hypertension Stage 2"</span>,</span>
<span id="cb45-364"><a href="#cb45-364" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb45-365"><a href="#cb45-365" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-366"><a href="#cb45-366" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-367"><a href="#cb45-367" aria-hidden="true" tabindex="-1"></a>    <span class="at">Diastolic_BP_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb45-368"><a href="#cb45-368" aria-hidden="true" tabindex="-1"></a>      Diastolic_BP <span class="sc">&lt;</span> <span class="dv">80</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb45-369"><a href="#cb45-369" aria-hidden="true" tabindex="-1"></a>      Diastolic_BP <span class="sc">&gt;=</span> <span class="dv">80</span> <span class="sc">&amp;</span> Diastolic_BP <span class="sc">&lt;</span> <span class="dv">90</span> <span class="sc">~</span> <span class="st">"Elevated"</span>,</span>
<span id="cb45-370"><a href="#cb45-370" aria-hidden="true" tabindex="-1"></a>      Diastolic_BP <span class="sc">&gt;=</span> <span class="dv">90</span> <span class="sc">&amp;</span> Diastolic_BP <span class="sc">&lt;</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"Hypertension Stage 1"</span>,</span>
<span id="cb45-371"><a href="#cb45-371" aria-hidden="true" tabindex="-1"></a>      Diastolic_BP <span class="sc">&gt;=</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"Hypertension Stage 2"</span>,</span>
<span id="cb45-372"><a href="#cb45-372" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb45-373"><a href="#cb45-373" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-374"><a href="#cb45-374" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-375"><a href="#cb45-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-376"><a href="#cb45-376" aria-hidden="true" tabindex="-1"></a><span class="co"># View the modified dataframe with new categorical variables</span></span>
<span id="cb45-377"><a href="#cb45-377" aria-hidden="true" tabindex="-1"></a>heart_attack_1</span>
<span id="cb45-378"><a href="#cb45-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-379"><a href="#cb45-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-380"><a href="#cb45-380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-381"><a href="#cb45-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-382"><a href="#cb45-382" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3.5.2 Recoding `age` into categorical variable</span></span>
<span id="cb45-383"><a href="#cb45-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-384"><a href="#cb45-384" aria-hidden="true" tabindex="-1"></a>While analyzing age as a continuous variable provides detailed insights, categorizing the <span class="in">`Age`</span> variable into distinct age groups allows us to explore how age influences the likelihood of heart attack incidents.</span>
<span id="cb45-385"><a href="#cb45-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-386"><a href="#cb45-386" aria-hidden="true" tabindex="-1"></a>The table below are the proposed age categories for this analysis:</span>
<span id="cb45-387"><a href="#cb45-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-388"><a href="#cb45-388" aria-hidden="true" tabindex="-1"></a>| Categories         | Age         |</span>
<span id="cb45-389"><a href="#cb45-389" aria-hidden="true" tabindex="-1"></a>|--------------------|-------------|</span>
<span id="cb45-390"><a href="#cb45-390" aria-hidden="true" tabindex="-1"></a>| Youth              | ≤25 years   |</span>
<span id="cb45-391"><a href="#cb45-391" aria-hidden="true" tabindex="-1"></a>| Young adults       | 26–40 years |</span>
<span id="cb45-392"><a href="#cb45-392" aria-hidden="true" tabindex="-1"></a>| Middle-aged adults | 41–55 years |</span>
<span id="cb45-393"><a href="#cb45-393" aria-hidden="true" tabindex="-1"></a>| Older adults       | 56–70 years |</span>
<span id="cb45-394"><a href="#cb45-394" aria-hidden="true" tabindex="-1"></a>| Elderly            | ≥71 years   |</span>
<span id="cb45-395"><a href="#cb45-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-398"><a href="#cb45-398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-399"><a href="#cb45-399" aria-hidden="true" tabindex="-1"></a>heart_attack_2 <span class="ot">&lt;-</span> heart_attack_1 <span class="sc">%&gt;%</span></span>
<span id="cb45-400"><a href="#cb45-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-401"><a href="#cb45-401" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb45-402"><a href="#cb45-402" aria-hidden="true" tabindex="-1"></a>      Age <span class="sc">&lt;=</span> <span class="dv">25</span> <span class="sc">~</span> <span class="st">"Youth"</span>,</span>
<span id="cb45-403"><a href="#cb45-403" aria-hidden="true" tabindex="-1"></a>      Age <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;=</span> <span class="dv">40</span> <span class="sc">~</span> <span class="st">"Young Adult"</span>,</span>
<span id="cb45-404"><a href="#cb45-404" aria-hidden="true" tabindex="-1"></a>      Age <span class="sc">&gt;=</span> <span class="dv">41</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;=</span> <span class="dv">55</span> <span class="sc">~</span> <span class="st">"Middle-Aged Adult"</span>,</span>
<span id="cb45-405"><a href="#cb45-405" aria-hidden="true" tabindex="-1"></a>      Age <span class="sc">&gt;=</span> <span class="dv">56</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;=</span> <span class="dv">70</span> <span class="sc">~</span> <span class="st">"Older Adult"</span>,</span>
<span id="cb45-406"><a href="#cb45-406" aria-hidden="true" tabindex="-1"></a>      Age <span class="sc">&gt;=</span> <span class="dv">71</span> <span class="sc">~</span> <span class="st">"Elderly"</span>,</span>
<span id="cb45-407"><a href="#cb45-407" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb45-408"><a href="#cb45-408" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-409"><a href="#cb45-409" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-410"><a href="#cb45-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-411"><a href="#cb45-411" aria-hidden="true" tabindex="-1"></a><span class="co"># View the updated dataset</span></span>
<span id="cb45-412"><a href="#cb45-412" aria-hidden="true" tabindex="-1"></a>heart_attack_2</span>
<span id="cb45-413"><a href="#cb45-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-414"><a href="#cb45-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-415"><a href="#cb45-415" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3.5.3 Checking the data structure after filtering and recoding of variables</span></span>
<span id="cb45-416"><a href="#cb45-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-417"><a href="#cb45-417" aria-hidden="true" tabindex="-1"></a>We will re-check the dataset after filtering and recoding of continuous variables using below:</span>
<span id="cb45-418"><a href="#cb45-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-419"><a href="#cb45-419" aria-hidden="true" tabindex="-1"></a>:::::: panel-tabset</span>
<span id="cb45-420"><a href="#cb45-420" aria-hidden="true" tabindex="-1"></a><span class="fu">## glimpse()</span></span>
<span id="cb45-421"><a href="#cb45-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-424"><a href="#cb45-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-425"><a href="#cb45-425" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(heart_attack_2)</span>
<span id="cb45-426"><a href="#cb45-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-427"><a href="#cb45-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-428"><a href="#cb45-428" aria-hidden="true" tabindex="-1"></a><span class="fu">## head()</span></span>
<span id="cb45-429"><a href="#cb45-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-432"><a href="#cb45-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-433"><a href="#cb45-433" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(heart_attack_2)</span>
<span id="cb45-434"><a href="#cb45-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-435"><a href="#cb45-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-436"><a href="#cb45-436" aria-hidden="true" tabindex="-1"></a><span class="fu">## summary()</span></span>
<span id="cb45-437"><a href="#cb45-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-440"><a href="#cb45-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-441"><a href="#cb45-441" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(heart_attack_2)</span>
<span id="cb45-442"><a href="#cb45-442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-443"><a href="#cb45-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-444"><a href="#cb45-444" aria-hidden="true" tabindex="-1"></a><span class="fu">## duplicated()</span></span>
<span id="cb45-445"><a href="#cb45-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-448"><a href="#cb45-448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-449"><a href="#cb45-449" aria-hidden="true" tabindex="-1"></a>heart_attack_2[<span class="fu">duplicated</span>(heart_attack_2),]</span>
<span id="cb45-450"><a href="#cb45-450" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-451"><a href="#cb45-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-452"><a href="#cb45-452" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb45-453"><a href="#cb45-453" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ensure that there are no duplicated columns, if not will have to investigate further.</span>
<span id="cb45-454"><a href="#cb45-454" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-455"><a href="#cb45-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-456"><a href="#cb45-456" aria-hidden="true" tabindex="-1"></a><span class="fu">## colSum(is.na())</span></span>
<span id="cb45-457"><a href="#cb45-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-460"><a href="#cb45-460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-461"><a href="#cb45-461" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(heart_attack_2))</span>
<span id="cb45-462"><a href="#cb45-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-463"><a href="#cb45-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-464"><a href="#cb45-464" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb45-465"><a href="#cb45-465" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ensure that there are no NA values, if not will have to investigate further.</span>
<span id="cb45-466"><a href="#cb45-466" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Possibility to use <span class="in">`drop_na()`</span> function to drop rows where any specified column contains a missing value.</span>
<span id="cb45-467"><a href="#cb45-467" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-468"><a href="#cb45-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-469"><a href="#cb45-469" aria-hidden="true" tabindex="-1"></a><span class="fu">## spec())</span></span>
<span id="cb45-470"><a href="#cb45-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-473"><a href="#cb45-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-474"><a href="#cb45-474" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span>(heart_attack_2)</span>
<span id="cb45-475"><a href="#cb45-475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-476"><a href="#cb45-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-477"><a href="#cb45-477" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb45-478"><a href="#cb45-478" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ensure that all variables are correctly classified by data type; recast variable types if needed.</span>
<span id="cb45-479"><a href="#cb45-479" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Variables are correctly classified - where categorical variables are classified as **character**, while continuous variables are classified as **double**.</span>
<span id="cb45-480"><a href="#cb45-480" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-481"><a href="#cb45-481" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb45-482"><a href="#cb45-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-483"><a href="#cb45-483" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb45-484"><a href="#cb45-484" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preprocessing Checks</span></span>
<span id="cb45-485"><a href="#cb45-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-486"><a href="#cb45-486" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Verified that the correct data types were loaded in the <span class="in">`heart_attack`</span> dataset using <span class="in">`glimpse()`</span> and <span class="in">`spec()`</span></span>
<span id="cb45-487"><a href="#cb45-487" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ensured there were no duplicate variable names using <span class="in">`duplicated()`</span> in the dataset</span>
<span id="cb45-488"><a href="#cb45-488" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Checked for missing values using <span class="in">`colSums(is.na())`</span></span>
<span id="cb45-489"><a href="#cb45-489" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-490"><a href="#cb45-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-491"><a href="#cb45-491" aria-hidden="true" tabindex="-1"></a>The final output - <span class="in">`heart_attack_2`</span> shows a tibble dataframe with 30,000 rows and 17 columns.</span>
<span id="cb45-492"><a href="#cb45-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-493"><a href="#cb45-493" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.6 Exploratory Data Analysis</span></span>
<span id="cb45-494"><a href="#cb45-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-495"><a href="#cb45-495" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3.6.1 EDA 0 - check for potential bias in data collection</span></span>
<span id="cb45-496"><a href="#cb45-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-497"><a href="#cb45-497" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb45-498"><a href="#cb45-498" aria-hidden="true" tabindex="-1"></a>**Key observations**</span>
<span id="cb45-499"><a href="#cb45-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-500"><a href="#cb45-500" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Uneven representation of age groups**</span>
<span id="cb45-501"><a href="#cb45-501" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Noticeably lower number of Youth (≤25 years) and Elderly (≥71 years) compared to the middle age groups</span>
<span id="cb45-502"><a href="#cb45-502" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Young adults (26–40 years), middle-aged adults (41–55 years), and older adults (56–70 years) make up the majority of the dataset</span>
<span id="cb45-503"><a href="#cb45-503" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Potential bias in data collection**</span>
<span id="cb45-504"><a href="#cb45-504" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Underrepresentation of elderly individuals might inflate their heart attack rate in percentage-based analyses</span>
<span id="cb45-505"><a href="#cb45-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-506"><a href="#cb45-506" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Low count of youth suggests they may be under-sampled</span>
<span id="cb45-507"><a href="#cb45-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-508"><a href="#cb45-508" aria-hidden="true" tabindex="-1"></a>**What can we do:**</span>
<span id="cb45-509"><a href="#cb45-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-510"><a href="#cb45-510" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In the future, ensure that the data collected are proportionally across all age groups</span>
<span id="cb45-511"><a href="#cb45-511" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Check for potential sampling bias</span>
<span id="cb45-512"><a href="#cb45-512" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Normalize the heart attack rates based on the total population for each age group</span>
<span id="cb45-513"><a href="#cb45-513" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-514"><a href="#cb45-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-515"><a href="#cb45-515" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb45-516"><a href="#cb45-516" aria-hidden="true" tabindex="-1"></a><span class="fu">## Absolute age count()</span></span>
<span id="cb45-517"><a href="#cb45-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-520"><a href="#cb45-520" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-521"><a href="#cb45-521" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of individuals by exact age</span></span>
<span id="cb45-522"><a href="#cb45-522" aria-hidden="true" tabindex="-1"></a>age_distribution <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-523"><a href="#cb45-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age) <span class="sc">%&gt;%</span></span>
<span id="cb45-524"><a href="#cb45-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb45-525"><a href="#cb45-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Age)</span>
<span id="cb45-526"><a href="#cb45-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-527"><a href="#cb45-527" aria-hidden="true" tabindex="-1"></a><span class="co"># Print age count</span></span>
<span id="cb45-528"><a href="#cb45-528" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(age_distribution)</span>
<span id="cb45-529"><a href="#cb45-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-530"><a href="#cb45-530" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-531"><a href="#cb45-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-532"><a href="#cb45-532" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualization: Absolute age count()</span></span>
<span id="cb45-533"><a href="#cb45-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-536"><a href="#cb45-536" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-537"><a href="#cb45-537" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(age_distribution, <span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Count)) <span class="sc">+</span></span>
<span id="cb45-538"><a href="#cb45-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#78B3EA"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb45-539"><a href="#cb45-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Age Distribution of Individuals in Dataset"</span>,</span>
<span id="cb45-540"><a href="#cb45-540" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age"</span>,</span>
<span id="cb45-541"><a href="#cb45-541" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Individuals"</span>) <span class="sc">+</span></span>
<span id="cb45-542"><a href="#cb45-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb45-543"><a href="#cb45-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-544"><a href="#cb45-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-545"><a href="#cb45-545" aria-hidden="true" tabindex="-1"></a><span class="fu">## Count by Age_Category()</span></span>
<span id="cb45-546"><a href="#cb45-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-549"><a href="#cb45-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-550"><a href="#cb45-550" aria-hidden="true" tabindex="-1"></a><span class="co"># Define age category levels in the required order</span></span>
<span id="cb45-551"><a href="#cb45-551" aria-hidden="true" tabindex="-1"></a>age_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb45-552"><a href="#cb45-552" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Youth (≤25 years)"</span>,</span>
<span id="cb45-553"><a href="#cb45-553" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Young adults (26–40 years)"</span>,</span>
<span id="cb45-554"><a href="#cb45-554" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Older adults (56–70 years)"</span>,</span>
<span id="cb45-555"><a href="#cb45-555" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Middle-aged adults (41–55 years)"</span>,</span>
<span id="cb45-556"><a href="#cb45-556" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Elderly (≥71 years)"</span></span>
<span id="cb45-557"><a href="#cb45-557" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-558"><a href="#cb45-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-559"><a href="#cb45-559" aria-hidden="true" tabindex="-1"></a><span class="co"># Count individuals by Age Category with ordered factor levels</span></span>
<span id="cb45-560"><a href="#cb45-560" aria-hidden="true" tabindex="-1"></a>age_category_distribution <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-561"><a href="#cb45-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb45-562"><a href="#cb45-562" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">&lt;=</span> <span class="dv">25</span> <span class="sc">~</span> <span class="st">"Youth (≤25 years)"</span>,</span>
<span id="cb45-563"><a href="#cb45-563" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;=</span> <span class="dv">40</span> <span class="sc">~</span> <span class="st">"Young adults (26–40 years)"</span>,</span>
<span id="cb45-564"><a href="#cb45-564" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">&gt;=</span> <span class="dv">41</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;=</span> <span class="dv">55</span> <span class="sc">~</span> <span class="st">"Middle-aged adults (41–55 years)"</span>,</span>
<span id="cb45-565"><a href="#cb45-565" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">&gt;=</span> <span class="dv">56</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;=</span> <span class="dv">70</span> <span class="sc">~</span> <span class="st">"Older adults (56–70 years)"</span>,</span>
<span id="cb45-566"><a href="#cb45-566" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">&gt;=</span> <span class="dv">71</span> <span class="sc">~</span> <span class="st">"Elderly (≥71 years)"</span>,</span>
<span id="cb45-567"><a href="#cb45-567" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb45-568"><a href="#cb45-568" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb45-569"><a href="#cb45-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Category) <span class="sc">%&gt;%</span></span>
<span id="cb45-570"><a href="#cb45-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb45-571"><a href="#cb45-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Category =</span> <span class="fu">factor</span>(Age_Category, <span class="at">levels =</span> age_levels)) <span class="sc">%&gt;%</span>  <span class="co"># Apply custom sorting</span></span>
<span id="cb45-572"><a href="#cb45-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Age_Category)</span>
<span id="cb45-573"><a href="#cb45-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-574"><a href="#cb45-574" aria-hidden="true" tabindex="-1"></a><span class="co"># Print age category count</span></span>
<span id="cb45-575"><a href="#cb45-575" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(age_category_distribution)</span>
<span id="cb45-576"><a href="#cb45-576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-577"><a href="#cb45-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-578"><a href="#cb45-578" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualization: Age_Category()</span></span>
<span id="cb45-579"><a href="#cb45-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-582"><a href="#cb45-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-583"><a href="#cb45-583" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization: Age Category Distribution</span></span>
<span id="cb45-584"><a href="#cb45-584" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(age_category_distribution, <span class="fu">aes</span>(<span class="at">x =</span> Age_Category, <span class="at">y =</span> Count, <span class="at">fill =</span> Age_Category)) <span class="sc">+</span></span>
<span id="cb45-585"><a href="#cb45-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb45-586"><a href="#cb45-586" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-587"><a href="#cb45-587" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add text labels above bars</span></span>
<span id="cb45-588"><a href="#cb45-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Count), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb45-589"><a href="#cb45-589" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-590"><a href="#cb45-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Age Category Distribution in Dataset"</span>,</span>
<span id="cb45-591"><a href="#cb45-591" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Category"</span>,</span>
<span id="cb45-592"><a href="#cb45-592" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Individuals"</span>) <span class="sc">+</span></span>
<span id="cb45-593"><a href="#cb45-593" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-594"><a href="#cb45-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-595"><a href="#cb45-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb45-596"><a href="#cb45-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb45-597"><a href="#cb45-597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-598"><a href="#cb45-598" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-599"><a href="#cb45-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-600"><a href="#cb45-600" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3.6.2 EDA 1 - explore how age influences the likelihood of heart attack incidents</span></span>
<span id="cb45-601"><a href="#cb45-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-602"><a href="#cb45-602" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 3.6.2.1 Age distribution of heart attack patients - histogram</span></span>
<span id="cb45-603"><a href="#cb45-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-604"><a href="#cb45-604" aria-hidden="true" tabindex="-1"></a>Observations:</span>
<span id="cb45-605"><a href="#cb45-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-606"><a href="#cb45-606" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Heart attacks occur across all ages:**</span>
<span id="cb45-607"><a href="#cb45-607" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Histogram shows a wide distribution of heart attack patients across various age groups</span>
<span id="cb45-608"><a href="#cb45-608" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Age group variation in heart attack rates:**</span>
<span id="cb45-609"><a href="#cb45-609" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Heart attack rate appears to be relatively stable across most age bins, ranging between 8.6% to 11.3%.</span>
<span id="cb45-610"><a href="#cb45-610" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Highest normalized heart attack rate is in the <span class="sc">\[</span>73,78<span class="sc">\]</span> age bin (\~11.3%).</span>
<span id="cb45-611"><a href="#cb45-611" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Gradual increase in heart attack rates:**</span>
<span id="cb45-612"><a href="#cb45-612" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Gradual increase in heart attack rates between younger groups <span class="sc">\[</span>18,23<span class="sc">\]</span> to middle-aged adults <span class="sc">\[</span>38,43<span class="sc">\]</span></span>
<span id="cb45-613"><a href="#cb45-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-614"><a href="#cb45-614" aria-hidden="true" tabindex="-1"></a>:::: panel-tabset</span>
<span id="cb45-615"><a href="#cb45-615" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code()</span></span>
<span id="cb45-616"><a href="#cb45-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-617"><a href="#cb45-617" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb45-618"><a href="#cb45-618" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The <span class="in">`cut()`</span>function was used to divide a continuous variable (like Age) into discrete intervals such as bins.</span>
<span id="cb45-619"><a href="#cb45-619" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`cut()`</span> function is part of Base R, which does not require any additional packages to use.</span>
<span id="cb45-620"><a href="#cb45-620" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-621"><a href="#cb45-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-624"><a href="#cb45-624" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-625"><a href="#cb45-625" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval = FALSE</span></span>
<span id="cb45-626"><a href="#cb45-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-627"><a href="#cb45-627" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb45-628"><a href="#cb45-628" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb45-629"><a href="#cb45-629" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb45-630"><a href="#cb45-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-631"><a href="#cb45-631" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Remove any NA values in Age before binning</span></span>
<span id="cb45-632"><a href="#cb45-632" aria-hidden="true" tabindex="-1"></a>heart_attack_2 <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-633"><a href="#cb45-633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Age)) <span class="sc">%&gt;%</span>  <span class="co"># Remove missing Age values</span></span>
<span id="cb45-634"><a href="#cb45-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Bin =</span> <span class="fu">cut</span>(Age, </span>
<span id="cb45-635"><a href="#cb45-635" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">floor</span>(<span class="fu">min</span>(Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb45-636"><a href="#cb45-636" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">ceiling</span>(<span class="fu">max</span>(Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span> <span class="dv">5</span>,  </span>
<span id="cb45-637"><a href="#cb45-637" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">by =</span> <span class="dv">5</span>), </span>
<span id="cb45-638"><a href="#cb45-638" aria-hidden="true" tabindex="-1"></a>                       <span class="at">right =</span> <span class="cn">FALSE</span>))  </span>
<span id="cb45-639"><a href="#cb45-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-640"><a href="#cb45-640" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Count total individuals per age bin</span></span>
<span id="cb45-641"><a href="#cb45-641" aria-hidden="true" tabindex="-1"></a>total_population <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-642"><a href="#cb45-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Bin) <span class="sc">%&gt;%</span></span>
<span id="cb45-643"><a href="#cb45-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total_Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb45-644"><a href="#cb45-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-645"><a href="#cb45-645" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Count heart attack occurrences per age bin</span></span>
<span id="cb45-646"><a href="#cb45-646" aria-hidden="true" tabindex="-1"></a>heart_attack_counts <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-647"><a href="#cb45-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-648"><a href="#cb45-648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Bin) <span class="sc">%&gt;%</span></span>
<span id="cb45-649"><a href="#cb45-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Heart_Attack_Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb45-650"><a href="#cb45-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-651"><a href="#cb45-651" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Merge the two tables and replace NA values with 0</span></span>
<span id="cb45-652"><a href="#cb45-652" aria-hidden="true" tabindex="-1"></a>normalized_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(total_population, heart_attack_counts, <span class="at">by =</span> <span class="st">"Age_Bin"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-653"><a href="#cb45-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Heart_Attack_Count =</span> <span class="fu">replace_na</span>(Heart_Attack_Count, <span class="dv">0</span>),  <span class="co"># Replace NA counts with 0</span></span>
<span id="cb45-654"><a href="#cb45-654" aria-hidden="true" tabindex="-1"></a>         <span class="at">Normalized_Heart_Attack_Rate =</span> (Heart_Attack_Count <span class="sc">/</span> Total_Count) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-655"><a href="#cb45-655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Age_Bin))  <span class="co"># Ensure Age_Bin does not contain NA values</span></span>
<span id="cb45-656"><a href="#cb45-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-657"><a href="#cb45-657" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Create the normalized histogram</span></span>
<span id="cb45-658"><a href="#cb45-658" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normalized_data, <span class="fu">aes</span>(<span class="at">x =</span> Age_Bin, <span class="at">y =</span> Normalized_Heart_Attack_Rate, <span class="at">fill =</span> Age_Bin)) <span class="sc">+</span></span>
<span id="cb45-659"><a href="#cb45-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb45-660"><a href="#cb45-660" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-661"><a href="#cb45-661" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add text labels showing the percentage per bin</span></span>
<span id="cb45-662"><a href="#cb45-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Normalized_Heart_Attack_Rate)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb45-663"><a href="#cb45-663" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-664"><a href="#cb45-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normalized Age Distribution of Heart Attack Patients"</span>,</span>
<span id="cb45-665"><a href="#cb45-665" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Groups (Binned by 5 Years)"</span>,</span>
<span id="cb45-666"><a href="#cb45-666" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Heart Attack Rate (Normalized, % of total in group)"</span>) <span class="sc">+</span></span>
<span id="cb45-667"><a href="#cb45-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-668"><a href="#cb45-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  </span>
<span id="cb45-669"><a href="#cb45-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-670"><a href="#cb45-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-671"><a href="#cb45-671" aria-hidden="true" tabindex="-1"></a><span class="fu">## Graph()</span></span>
<span id="cb45-672"><a href="#cb45-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-675"><a href="#cb45-675" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-676"><a href="#cb45-676" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo = FALSE </span></span>
<span id="cb45-677"><a href="#cb45-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-678"><a href="#cb45-678" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb45-679"><a href="#cb45-679" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb45-680"><a href="#cb45-680" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb45-681"><a href="#cb45-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-682"><a href="#cb45-682" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Remove any NA values in Age before binning</span></span>
<span id="cb45-683"><a href="#cb45-683" aria-hidden="true" tabindex="-1"></a>heart_attack_2 <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-684"><a href="#cb45-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Age)) <span class="sc">%&gt;%</span>  <span class="co"># Remove missing Age values</span></span>
<span id="cb45-685"><a href="#cb45-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Bin =</span> <span class="fu">cut</span>(Age, </span>
<span id="cb45-686"><a href="#cb45-686" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">floor</span>(<span class="fu">min</span>(Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb45-687"><a href="#cb45-687" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">ceiling</span>(<span class="fu">max</span>(Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span> <span class="dv">5</span>,  </span>
<span id="cb45-688"><a href="#cb45-688" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">by =</span> <span class="dv">5</span>), </span>
<span id="cb45-689"><a href="#cb45-689" aria-hidden="true" tabindex="-1"></a>                       <span class="at">right =</span> <span class="cn">FALSE</span>))  </span>
<span id="cb45-690"><a href="#cb45-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-691"><a href="#cb45-691" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Count total individuals per age bin</span></span>
<span id="cb45-692"><a href="#cb45-692" aria-hidden="true" tabindex="-1"></a>total_population <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-693"><a href="#cb45-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Bin) <span class="sc">%&gt;%</span></span>
<span id="cb45-694"><a href="#cb45-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total_Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb45-695"><a href="#cb45-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-696"><a href="#cb45-696" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Count heart attack occurrences per age bin</span></span>
<span id="cb45-697"><a href="#cb45-697" aria-hidden="true" tabindex="-1"></a>heart_attack_counts <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-698"><a href="#cb45-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-699"><a href="#cb45-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Bin) <span class="sc">%&gt;%</span></span>
<span id="cb45-700"><a href="#cb45-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Heart_Attack_Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb45-701"><a href="#cb45-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-702"><a href="#cb45-702" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Merge the two tables and replace NA values with 0</span></span>
<span id="cb45-703"><a href="#cb45-703" aria-hidden="true" tabindex="-1"></a>normalized_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(total_population, heart_attack_counts, <span class="at">by =</span> <span class="st">"Age_Bin"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-704"><a href="#cb45-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Heart_Attack_Count =</span> <span class="fu">replace_na</span>(Heart_Attack_Count, <span class="dv">0</span>),  <span class="co"># Replace NA counts with 0</span></span>
<span id="cb45-705"><a href="#cb45-705" aria-hidden="true" tabindex="-1"></a>         <span class="at">Normalized_Heart_Attack_Rate =</span> (Heart_Attack_Count <span class="sc">/</span> Total_Count) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-706"><a href="#cb45-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Age_Bin))  <span class="co"># Ensure Age_Bin does not contain NA values</span></span>
<span id="cb45-707"><a href="#cb45-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-708"><a href="#cb45-708" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Create the normalized histogram</span></span>
<span id="cb45-709"><a href="#cb45-709" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normalized_data, <span class="fu">aes</span>(<span class="at">x =</span> Age_Bin, <span class="at">y =</span> Normalized_Heart_Attack_Rate, <span class="at">fill =</span> Age_Bin)) <span class="sc">+</span></span>
<span id="cb45-710"><a href="#cb45-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb45-711"><a href="#cb45-711" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-712"><a href="#cb45-712" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add text labels showing the percentage per bin</span></span>
<span id="cb45-713"><a href="#cb45-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Normalized_Heart_Attack_Rate)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb45-714"><a href="#cb45-714" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-715"><a href="#cb45-715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normalized Age Distribution of Heart Attack Patients"</span>,</span>
<span id="cb45-716"><a href="#cb45-716" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Groups (Binned by 5 Years)"</span>,</span>
<span id="cb45-717"><a href="#cb45-717" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Heart Attack Rate (Normalized, % of total in group)"</span>) <span class="sc">+</span></span>
<span id="cb45-718"><a href="#cb45-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-719"><a href="#cb45-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  </span>
<span id="cb45-720"><a href="#cb45-720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-721"><a href="#cb45-721" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb45-722"><a href="#cb45-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-723"><a href="#cb45-723" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 3.6.2.2 Heart attack rate by age group - histogram</span></span>
<span id="cb45-724"><a href="#cb45-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-725"><a href="#cb45-725" aria-hidden="true" tabindex="-1"></a>Another point of view, categorizing ages into groups and calculating the heart attack rate for each group.</span>
<span id="cb45-726"><a href="#cb45-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-727"><a href="#cb45-727" aria-hidden="true" tabindex="-1"></a>Observations:</span>
<span id="cb45-728"><a href="#cb45-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-729"><a href="#cb45-729" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Almost similar rates across age groups :**</span>
<span id="cb45-730"><a href="#cb45-730" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Heart attack rates range between 8.9% and 10.3%, showing no extreme variation.</span>
<span id="cb45-731"><a href="#cb45-731" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Young Adults (26–40) &amp; Elderly (≥71) have the highest rate - at 10.3%</span>
<span id="cb45-732"><a href="#cb45-732" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Youth (≤25) has the lowest rate - at 8.9%, only slightly lower than other groups.</span>
<span id="cb45-733"><a href="#cb45-733" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Suggests that age alone may not be the strongest predictor of heart attack risk, and other lifestyle or health factors might play a key role.**</span>
<span id="cb45-734"><a href="#cb45-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-735"><a href="#cb45-735" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb45-736"><a href="#cb45-736" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code()</span></span>
<span id="cb45-737"><a href="#cb45-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-740"><a href="#cb45-740" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-741"><a href="#cb45-741" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval = FALSE</span></span>
<span id="cb45-742"><a href="#cb45-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-743"><a href="#cb45-743" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Age Category Labels with Age Ranges</span></span>
<span id="cb45-744"><a href="#cb45-744" aria-hidden="true" tabindex="-1"></a>age_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb45-745"><a href="#cb45-745" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Youth (≤25 years)"</span>, </span>
<span id="cb45-746"><a href="#cb45-746" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Young adults (26–40 years)"</span>, </span>
<span id="cb45-747"><a href="#cb45-747" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Middle-aged adults (41–55 years)"</span>, </span>
<span id="cb45-748"><a href="#cb45-748" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Older adults (56–70 years)"</span>, </span>
<span id="cb45-749"><a href="#cb45-749" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Elderly (≥71 years)"</span></span>
<span id="cb45-750"><a href="#cb45-750" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-751"><a href="#cb45-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-752"><a href="#cb45-752" aria-hidden="true" tabindex="-1"></a><span class="co"># Count total individuals per age category</span></span>
<span id="cb45-753"><a href="#cb45-753" aria-hidden="true" tabindex="-1"></a>total_population <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-754"><a href="#cb45-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Category) <span class="sc">%&gt;%</span></span>
<span id="cb45-755"><a href="#cb45-755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total_Count =</span> <span class="fu">n</span>())</span>
<span id="cb45-756"><a href="#cb45-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-757"><a href="#cb45-757" aria-hidden="true" tabindex="-1"></a><span class="co"># Count heart attack occurrences per age category</span></span>
<span id="cb45-758"><a href="#cb45-758" aria-hidden="true" tabindex="-1"></a>heart_attack_counts <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-759"><a href="#cb45-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-760"><a href="#cb45-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Category) <span class="sc">%&gt;%</span></span>
<span id="cb45-761"><a href="#cb45-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Heart_Attack_Count =</span> <span class="fu">n</span>())</span>
<span id="cb45-762"><a href="#cb45-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-763"><a href="#cb45-763" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge both datasets and calculate the normalized heart attack rate</span></span>
<span id="cb45-764"><a href="#cb45-764" aria-hidden="true" tabindex="-1"></a>normalized_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(heart_attack_counts, total_population, <span class="at">by =</span> <span class="st">"Age_Category"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-765"><a href="#cb45-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Normalized_Heart_Attack_Rate =</span> (Heart_Attack_Count <span class="sc">/</span> Total_Count) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-766"><a href="#cb45-766" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-767"><a href="#cb45-767" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert Age_Category into a factor with labels</span></span>
<span id="cb45-768"><a href="#cb45-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Category =</span> <span class="fu">factor</span>(Age_Category, </span>
<span id="cb45-769"><a href="#cb45-769" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Youth"</span>, <span class="st">"Young Adult"</span>, <span class="st">"Middle-Aged Adult"</span>, <span class="st">"Older Adult"</span>, <span class="st">"Elderly"</span>), </span>
<span id="cb45-770"><a href="#cb45-770" aria-hidden="true" tabindex="-1"></a>                               <span class="at">labels =</span> age_labels))</span>
<span id="cb45-771"><a href="#cb45-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-772"><a href="#cb45-772" aria-hidden="true" tabindex="-1"></a><span class="co"># Create bar plot with normalized rates</span></span>
<span id="cb45-773"><a href="#cb45-773" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normalized_data, <span class="fu">aes</span>(<span class="at">x =</span> Age_Category, <span class="at">y =</span> Normalized_Heart_Attack_Rate, <span class="at">fill =</span> Age_Category)) <span class="sc">+</span></span>
<span id="cb45-774"><a href="#cb45-774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb45-775"><a href="#cb45-775" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-776"><a href="#cb45-776" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add data labels to show percentages</span></span>
<span id="cb45-777"><a href="#cb45-777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Normalized_Heart_Attack_Rate)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>,<span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb45-778"><a href="#cb45-778" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-779"><a href="#cb45-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normalized Heart Attack Rate by Age Group"</span>,</span>
<span id="cb45-780"><a href="#cb45-780" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Group"</span>,</span>
<span id="cb45-781"><a href="#cb45-781" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Heart Attack Rate (% of total in group)"</span>,</span>
<span id="cb45-782"><a href="#cb45-782" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Age Categories (with Ranges)"</span>) <span class="sc">+</span>  <span class="co"># Updated legend title</span></span>
<span id="cb45-783"><a href="#cb45-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-784"><a href="#cb45-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb45-785"><a href="#cb45-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb45-786"><a href="#cb45-786" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))  </span>
<span id="cb45-787"><a href="#cb45-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-788"><a href="#cb45-788" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-789"><a href="#cb45-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-790"><a href="#cb45-790" aria-hidden="true" tabindex="-1"></a><span class="fu">## Graph()</span></span>
<span id="cb45-791"><a href="#cb45-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-794"><a href="#cb45-794" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-795"><a href="#cb45-795" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo = FALSE </span></span>
<span id="cb45-796"><a href="#cb45-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-797"><a href="#cb45-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-798"><a href="#cb45-798" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Age Category Labels with Age Ranges</span></span>
<span id="cb45-799"><a href="#cb45-799" aria-hidden="true" tabindex="-1"></a>age_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb45-800"><a href="#cb45-800" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Youth (≤25 years)"</span>, </span>
<span id="cb45-801"><a href="#cb45-801" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Young adults (26–40 years)"</span>, </span>
<span id="cb45-802"><a href="#cb45-802" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Middle-aged adults (41–55 years)"</span>, </span>
<span id="cb45-803"><a href="#cb45-803" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Older adults (56–70 years)"</span>, </span>
<span id="cb45-804"><a href="#cb45-804" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Elderly (≥71 years)"</span></span>
<span id="cb45-805"><a href="#cb45-805" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-806"><a href="#cb45-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-807"><a href="#cb45-807" aria-hidden="true" tabindex="-1"></a><span class="co"># Count total individuals per age category</span></span>
<span id="cb45-808"><a href="#cb45-808" aria-hidden="true" tabindex="-1"></a>total_population <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-809"><a href="#cb45-809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Category) <span class="sc">%&gt;%</span></span>
<span id="cb45-810"><a href="#cb45-810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total_Count =</span> <span class="fu">n</span>())</span>
<span id="cb45-811"><a href="#cb45-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-812"><a href="#cb45-812" aria-hidden="true" tabindex="-1"></a><span class="co"># Count heart attack occurrences per age category</span></span>
<span id="cb45-813"><a href="#cb45-813" aria-hidden="true" tabindex="-1"></a>heart_attack_counts <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-814"><a href="#cb45-814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-815"><a href="#cb45-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Category) <span class="sc">%&gt;%</span></span>
<span id="cb45-816"><a href="#cb45-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Heart_Attack_Count =</span> <span class="fu">n</span>())</span>
<span id="cb45-817"><a href="#cb45-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-818"><a href="#cb45-818" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge both datasets and calculate the normalized heart attack rate</span></span>
<span id="cb45-819"><a href="#cb45-819" aria-hidden="true" tabindex="-1"></a>normalized_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(heart_attack_counts, total_population, <span class="at">by =</span> <span class="st">"Age_Category"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-820"><a href="#cb45-820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Normalized_Heart_Attack_Rate =</span> (Heart_Attack_Count <span class="sc">/</span> Total_Count) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-821"><a href="#cb45-821" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-822"><a href="#cb45-822" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert Age_Category into a factor with labels</span></span>
<span id="cb45-823"><a href="#cb45-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Category =</span> <span class="fu">factor</span>(Age_Category, </span>
<span id="cb45-824"><a href="#cb45-824" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Youth"</span>, <span class="st">"Young Adult"</span>, <span class="st">"Middle-Aged Adult"</span>, <span class="st">"Older Adult"</span>, <span class="st">"Elderly"</span>), </span>
<span id="cb45-825"><a href="#cb45-825" aria-hidden="true" tabindex="-1"></a>                               <span class="at">labels =</span> age_labels))</span>
<span id="cb45-826"><a href="#cb45-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-827"><a href="#cb45-827" aria-hidden="true" tabindex="-1"></a><span class="co"># Create bar plot with normalized rates</span></span>
<span id="cb45-828"><a href="#cb45-828" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normalized_data, <span class="fu">aes</span>(<span class="at">x =</span> Age_Category, <span class="at">y =</span> Normalized_Heart_Attack_Rate, <span class="at">fill =</span> Age_Category)) <span class="sc">+</span></span>
<span id="cb45-829"><a href="#cb45-829" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb45-830"><a href="#cb45-830" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-831"><a href="#cb45-831" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add data labels to show percentages</span></span>
<span id="cb45-832"><a href="#cb45-832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Normalized_Heart_Attack_Rate)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>,<span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb45-833"><a href="#cb45-833" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-834"><a href="#cb45-834" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normalized Heart Attack Rate by Age Group"</span>,</span>
<span id="cb45-835"><a href="#cb45-835" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Group"</span>,</span>
<span id="cb45-836"><a href="#cb45-836" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Heart Attack Rate (% of total in group)"</span>,</span>
<span id="cb45-837"><a href="#cb45-837" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Age Categories (with Ranges)"</span>) <span class="sc">+</span>  <span class="co"># Updated legend title</span></span>
<span id="cb45-838"><a href="#cb45-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-839"><a href="#cb45-839" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb45-840"><a href="#cb45-840" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb45-841"><a href="#cb45-841" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))  </span>
<span id="cb45-842"><a href="#cb45-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-843"><a href="#cb45-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-844"><a href="#cb45-844" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-845"><a href="#cb45-845" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-846"><a href="#cb45-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-847"><a href="#cb45-847" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 3.6.2.3 Age distribution differs between heart attack occurences - ridgeline density plot</span></span>
<span id="cb45-848"><a href="#cb45-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-849"><a href="#cb45-849" aria-hidden="true" tabindex="-1"></a>Observations:</span>
<span id="cb45-850"><a href="#cb45-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-851"><a href="#cb45-851" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Heart Attack Occurence = "No" group is more evenly distributed across age ranges</span>
<span id="cb45-852"><a href="#cb45-852" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Heart attacks are more common in Young adults and older individuals (higher density for "Yes" group in older ages).</span>
<span id="cb45-853"><a href="#cb45-853" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Youth rarely experience heart attacks, though some cases exist.</span>
<span id="cb45-854"><a href="#cb45-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-855"><a href="#cb45-855" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb45-856"><a href="#cb45-856" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code()</span></span>
<span id="cb45-857"><a href="#cb45-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-860"><a href="#cb45-860" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-861"><a href="#cb45-861" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval = FALSE</span></span>
<span id="cb45-862"><a href="#cb45-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-863"><a href="#cb45-863" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure Heart Attack Occurrence is a factor</span></span>
<span id="cb45-864"><a href="#cb45-864" aria-hidden="true" tabindex="-1"></a>heart_attack_2 <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-865"><a href="#cb45-865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Heart_Attack_Occurrence =</span> <span class="fu">factor</span>(Heart_Attack_Occurrence, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)))</span>
<span id="cb45-866"><a href="#cb45-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-867"><a href="#cb45-867" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Ridgeline Density Plot </span></span>
<span id="cb45-868"><a href="#cb45-868" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heart_attack_2, <span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Heart_Attack_Occurrence, <span class="at">fill =</span> <span class="fu">after_stat</span>(x))) <span class="sc">+</span></span>
<span id="cb45-869"><a href="#cb45-869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges_gradient</span>(<span class="at">scale =</span> <span class="dv">2</span>, <span class="at">rel_min_height =</span> <span class="fl">0.01</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb45-870"><a href="#cb45-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"magma"</span>) <span class="sc">+</span>  </span>
<span id="cb45-871"><a href="#cb45-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-872"><a href="#cb45-872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ridgeline Density Plot: Age Distribution by Heart Attack Occurrence"</span>,</span>
<span id="cb45-873"><a href="#cb45-873" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age"</span>,</span>
<span id="cb45-874"><a href="#cb45-874" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Heart Attack Occurrence"</span>,</span>
<span id="cb45-875"><a href="#cb45-875" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Age"</span>) <span class="sc">+</span>  </span>
<span id="cb45-876"><a href="#cb45-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-877"><a href="#cb45-877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-878"><a href="#cb45-878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb45-879"><a href="#cb45-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-880"><a href="#cb45-880" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-881"><a href="#cb45-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-882"><a href="#cb45-882" aria-hidden="true" tabindex="-1"></a><span class="fu">## Graph()</span></span>
<span id="cb45-883"><a href="#cb45-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-886"><a href="#cb45-886" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-887"><a href="#cb45-887" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo = FALSE </span></span>
<span id="cb45-888"><a href="#cb45-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-889"><a href="#cb45-889" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure Heart Attack Occurrence is a factor</span></span>
<span id="cb45-890"><a href="#cb45-890" aria-hidden="true" tabindex="-1"></a>heart_attack_2 <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-891"><a href="#cb45-891" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Heart_Attack_Occurrence =</span> <span class="fu">factor</span>(Heart_Attack_Occurrence, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)))</span>
<span id="cb45-892"><a href="#cb45-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-893"><a href="#cb45-893" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Ridgeline Density Plot </span></span>
<span id="cb45-894"><a href="#cb45-894" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heart_attack_2, <span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Heart_Attack_Occurrence, <span class="at">fill =</span> <span class="fu">after_stat</span>(x))) <span class="sc">+</span></span>
<span id="cb45-895"><a href="#cb45-895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges_gradient</span>(<span class="at">scale =</span> <span class="dv">2</span>, <span class="at">rel_min_height =</span> <span class="fl">0.01</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb45-896"><a href="#cb45-896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"magma"</span>) <span class="sc">+</span>  </span>
<span id="cb45-897"><a href="#cb45-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-898"><a href="#cb45-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ridgeline Density Plot: Age Distribution by Heart Attack Occurrence"</span>,</span>
<span id="cb45-899"><a href="#cb45-899" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age"</span>,</span>
<span id="cb45-900"><a href="#cb45-900" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Heart Attack Occurrence"</span>,</span>
<span id="cb45-901"><a href="#cb45-901" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Age"</span>) <span class="sc">+</span>  </span>
<span id="cb45-902"><a href="#cb45-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-903"><a href="#cb45-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-904"><a href="#cb45-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb45-905"><a href="#cb45-905" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-906"><a href="#cb45-906" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-907"><a href="#cb45-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-908"><a href="#cb45-908" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 3.6.2.2 Heart Attack Occurrence Across Age Categories – Funnel Plot Analysis</span></span>
<span id="cb45-909"><a href="#cb45-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-910"><a href="#cb45-910" aria-hidden="true" tabindex="-1"></a>The analysis is based on five age categories, with heart attack occurrence represented as a proportion.</span>
<span id="cb45-911"><a href="#cb45-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-912"><a href="#cb45-912" aria-hidden="true" tabindex="-1"></a>| Categories         | Age         |</span>
<span id="cb45-913"><a href="#cb45-913" aria-hidden="true" tabindex="-1"></a>|--------------------|-------------|</span>
<span id="cb45-914"><a href="#cb45-914" aria-hidden="true" tabindex="-1"></a>| Youth              | ≤25 years   |</span>
<span id="cb45-915"><a href="#cb45-915" aria-hidden="true" tabindex="-1"></a>| Young adults       | 26–40 years |</span>
<span id="cb45-916"><a href="#cb45-916" aria-hidden="true" tabindex="-1"></a>| Middle-aged adults | 41–55 years |</span>
<span id="cb45-917"><a href="#cb45-917" aria-hidden="true" tabindex="-1"></a>| Older adults       | 56–70 years |</span>
<span id="cb45-918"><a href="#cb45-918" aria-hidden="true" tabindex="-1"></a>| Elderly            | ≥71 years   |</span>
<span id="cb45-919"><a href="#cb45-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-920"><a href="#cb45-920" aria-hidden="true" tabindex="-1"></a>Observations:</span>
<span id="cb45-921"><a href="#cb45-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-922"><a href="#cb45-922" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>No overdispersion was detected, meaning the data does not exhibit excessive variance beyond what is expected.</span>
<span id="cb45-923"><a href="#cb45-923" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The funnel plot confirms that all data points fall within expected control limits, indicating no statistically significant outliers.</span>
<span id="cb45-924"><a href="#cb45-924" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Although, the heart attack occurrence rate varies among age categories but remains within the expected range.</span>
<span id="cb45-925"><a href="#cb45-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-926"><a href="#cb45-926" aria-hidden="true" tabindex="-1"></a>**Further analysis might be needed** to examine specific risk factors that contribute to heart attack rates in different age groups.</span>
<span id="cb45-927"><a href="#cb45-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-928"><a href="#cb45-928" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb45-929"><a href="#cb45-929" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code()</span></span>
<span id="cb45-930"><a href="#cb45-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-933"><a href="#cb45-933" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-934"><a href="#cb45-934" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval = FALSE</span></span>
<span id="cb45-935"><a href="#cb45-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-936"><a href="#cb45-936" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Convert "Yes"/"No" to 1/0</span></span>
<span id="cb45-937"><a href="#cb45-937" aria-hidden="true" tabindex="-1"></a>heart_attack_2 <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-938"><a href="#cb45-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Heart_Attack_Occurrence =</span> <span class="fu">ifelse</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb45-939"><a href="#cb45-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-940"><a href="#cb45-940" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Summarize data for all 5 age categories</span></span>
<span id="cb45-941"><a href="#cb45-941" aria-hidden="true" tabindex="-1"></a>age_summary <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-942"><a href="#cb45-942" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Category) <span class="sc">%&gt;%</span></span>
<span id="cb45-943"><a href="#cb45-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb45-944"><a href="#cb45-944" aria-hidden="true" tabindex="-1"></a>    <span class="at">Heart_Attack_Count =</span> <span class="fu">sum</span>(Heart_Attack_Occurrence, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Numerator</span></span>
<span id="cb45-945"><a href="#cb45-945" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Population =</span> <span class="fu">n</span>()  <span class="co"># Denominator</span></span>
<span id="cb45-946"><a href="#cb45-946" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-947"><a href="#cb45-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-948"><a href="#cb45-948" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Funnel Plot for all age categories</span></span>
<span id="cb45-949"><a href="#cb45-949" aria-hidden="true" tabindex="-1"></a><span class="fu">funnel_plot</span>(</span>
<span id="cb45-950"><a href="#cb45-950" aria-hidden="true" tabindex="-1"></a>  <span class="at">.data =</span> age_summary,</span>
<span id="cb45-951"><a href="#cb45-951" aria-hidden="true" tabindex="-1"></a>  <span class="at">numerator =</span> <span class="st">"Heart_Attack_Count"</span>,</span>
<span id="cb45-952"><a href="#cb45-952" aria-hidden="true" tabindex="-1"></a>  <span class="at">denominator =</span> <span class="st">"Total_Population"</span>,</span>
<span id="cb45-953"><a href="#cb45-953" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"Age_Category"</span>,</span>
<span id="cb45-954"><a href="#cb45-954" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_type =</span> <span class="st">"PR"</span>,  <span class="co"># Proportion Rate</span></span>
<span id="cb45-955"><a href="#cb45-955" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(age_summary<span class="sc">$</span>Total_Population) <span class="sc">+</span> <span class="dv">500</span>),  <span class="co"># Adjusted for better scaling</span></span>
<span id="cb45-956"><a href="#cb45-956" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(age_summary<span class="sc">$</span>Heart_Attack_Count <span class="sc">/</span> age_summary<span class="sc">$</span>Total_Population) <span class="sc">+</span> <span class="fl">0.02</span>)  <span class="co"># Ensure proportions are visible</span></span>
<span id="cb45-957"><a href="#cb45-957" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-958"><a href="#cb45-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-959"><a href="#cb45-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-960"><a href="#cb45-960" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-961"><a href="#cb45-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-962"><a href="#cb45-962" aria-hidden="true" tabindex="-1"></a><span class="fu">## Graph()</span></span>
<span id="cb45-965"><a href="#cb45-965" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-966"><a href="#cb45-966" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo = FALSE </span></span>
<span id="cb45-967"><a href="#cb45-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-968"><a href="#cb45-968" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Convert "Yes"/"No" to 1/0</span></span>
<span id="cb45-969"><a href="#cb45-969" aria-hidden="true" tabindex="-1"></a>heart_attack_2 <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-970"><a href="#cb45-970" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Heart_Attack_Occurrence =</span> <span class="fu">ifelse</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb45-971"><a href="#cb45-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-972"><a href="#cb45-972" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Summarize data for all 5 age categories</span></span>
<span id="cb45-973"><a href="#cb45-973" aria-hidden="true" tabindex="-1"></a>age_summary <span class="ot">&lt;-</span> heart_attack_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-974"><a href="#cb45-974" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Category) <span class="sc">%&gt;%</span></span>
<span id="cb45-975"><a href="#cb45-975" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb45-976"><a href="#cb45-976" aria-hidden="true" tabindex="-1"></a>    <span class="at">Heart_Attack_Count =</span> <span class="fu">sum</span>(Heart_Attack_Occurrence, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Numerator</span></span>
<span id="cb45-977"><a href="#cb45-977" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Population =</span> <span class="fu">n</span>()  <span class="co"># Denominator</span></span>
<span id="cb45-978"><a href="#cb45-978" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-979"><a href="#cb45-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-980"><a href="#cb45-980" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Funnel Plot for all age categories</span></span>
<span id="cb45-981"><a href="#cb45-981" aria-hidden="true" tabindex="-1"></a><span class="fu">funnel_plot</span>(</span>
<span id="cb45-982"><a href="#cb45-982" aria-hidden="true" tabindex="-1"></a>  <span class="at">.data =</span> age_summary,</span>
<span id="cb45-983"><a href="#cb45-983" aria-hidden="true" tabindex="-1"></a>  <span class="at">numerator =</span> <span class="st">"Heart_Attack_Count"</span>,</span>
<span id="cb45-984"><a href="#cb45-984" aria-hidden="true" tabindex="-1"></a>  <span class="at">denominator =</span> <span class="st">"Total_Population"</span>,</span>
<span id="cb45-985"><a href="#cb45-985" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"Age_Category"</span>,</span>
<span id="cb45-986"><a href="#cb45-986" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_type =</span> <span class="st">"PR"</span>,  <span class="co"># Proportion Rate</span></span>
<span id="cb45-987"><a href="#cb45-987" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(age_summary<span class="sc">$</span>Total_Population) <span class="sc">+</span> <span class="dv">500</span>),  <span class="co"># Adjusted for better scaling</span></span>
<span id="cb45-988"><a href="#cb45-988" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(age_summary<span class="sc">$</span>Heart_Attack_Count <span class="sc">/</span> age_summary<span class="sc">$</span>Total_Population) <span class="sc">+</span> <span class="fl">0.02</span>)  <span class="co"># Ensure proportions are visible</span></span>
<span id="cb45-989"><a href="#cb45-989" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-990"><a href="#cb45-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-991"><a href="#cb45-991" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-992"><a href="#cb45-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-993"><a href="#cb45-993" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-994"><a href="#cb45-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-995"><a href="#cb45-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-996"><a href="#cb45-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-997"><a href="#cb45-997" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r} --&gt;</span></span>
<span id="cb45-998"><a href="#cb45-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-999"><a href="#cb45-999" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- # Step 1: Count total individuals in each Age_Category --&gt;</span></span>
<span id="cb45-1000"><a href="#cb45-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1001"><a href="#cb45-1001" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- total_population &lt;- heart_attack_2 %&gt;% --&gt;</span></span>
<span id="cb45-1002"><a href="#cb45-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1003"><a href="#cb45-1003" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   group_by(Age_Category) %&gt;% --&gt;</span></span>
<span id="cb45-1004"><a href="#cb45-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1005"><a href="#cb45-1005" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   summarise(Total_Count = n()) --&gt;</span></span>
<span id="cb45-1006"><a href="#cb45-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1007"><a href="#cb45-1007" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- # Step 2: Count heart attack occurrences by Age_Category --&gt;</span></span>
<span id="cb45-1008"><a href="#cb45-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1009"><a href="#cb45-1009" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- heart_attack_counts &lt;- heart_attack_2 %&gt;% --&gt;</span></span>
<span id="cb45-1010"><a href="#cb45-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1011"><a href="#cb45-1011" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   filter(Heart_Attack_Occurrence == "Yes") %&gt;% --&gt;</span></span>
<span id="cb45-1012"><a href="#cb45-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1013"><a href="#cb45-1013" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   group_by(Age_Category) %&gt;% --&gt;</span></span>
<span id="cb45-1014"><a href="#cb45-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1015"><a href="#cb45-1015" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   summarise(Heart_Attack_Count = n()) --&gt;</span></span>
<span id="cb45-1016"><a href="#cb45-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1017"><a href="#cb45-1017" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- # Step 3: Merge the two tables --&gt;</span></span>
<span id="cb45-1018"><a href="#cb45-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1019"><a href="#cb45-1019" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- normalized_data &lt;- left_join(heart_attack_counts, total_population, by = "Age_Category") %&gt;% --&gt;</span></span>
<span id="cb45-1020"><a href="#cb45-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1021"><a href="#cb45-1021" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   mutate(Normalized_Heart_Attack_Rate = (Heart_Attack_Count / Total_Count) * 100) --&gt;</span></span>
<span id="cb45-1022"><a href="#cb45-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1023"><a href="#cb45-1023" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- # Step 4: Plot the normalized heart attack rate --&gt;</span></span>
<span id="cb45-1024"><a href="#cb45-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1025"><a href="#cb45-1025" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ggplot(normalized_data, aes(x = Age_Category, y = Normalized_Heart_Attack_Rate, fill = Age_Category)) + --&gt;</span></span>
<span id="cb45-1026"><a href="#cb45-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1027"><a href="#cb45-1027" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   geom_bar(stat = "identity", color = "black", alpha = 0.7) + --&gt;</span></span>
<span id="cb45-1028"><a href="#cb45-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1029"><a href="#cb45-1029" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   labs(title = "Normalized Heart Attack Rate by Age Group", --&gt;</span></span>
<span id="cb45-1030"><a href="#cb45-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1031"><a href="#cb45-1031" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--        x = "Age Group", --&gt;</span></span>
<span id="cb45-1032"><a href="#cb45-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1033"><a href="#cb45-1033" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--        y = "Heart Attack Rate (Normalized, % of total in group)") + --&gt;</span></span>
<span id="cb45-1034"><a href="#cb45-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1035"><a href="#cb45-1035" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   theme_minimal() + --&gt;</span></span>
<span id="cb45-1036"><a href="#cb45-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1037"><a href="#cb45-1037" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   scale_fill_brewer(palette = "Set2") + --&gt;</span></span>
<span id="cb45-1038"><a href="#cb45-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1039"><a href="#cb45-1039" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for readability --&gt;</span></span>
<span id="cb45-1040"><a href="#cb45-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1041"><a href="#cb45-1041" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb45-1042"><a href="#cb45-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1043"><a href="#cb45-1043" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ch</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>